#============================================================================
# Created    : 2008-03-06
# Maintainer : Patrick ROBBE, Gloria CORTI
#============================================================================
package GENSER
version v10r0

# Structure, i.e. directories to process. 
#============================================================================
branches doc cmt src

# Used packages
#============================================================================

use GaudiPolicy  v*

#-- Photos
#============================================================================
macro photos_native_version "215.4"
use photos v* LCG_GeneratorsInterfaces


#-- LHAPDF
#============================================================================
macro lhapdf_native_version "5.8.5"
use lhapdf v* LCG_GeneratorsInterfaces
set LHAPATH $(lhapdf_path)/share/lhapdf/PDFsets


#-- Herwig and Jimmy
#============================================================================
macro herwig_native_version "6.510.3"
macro jimmy_native_version "4.31.3"


#-- AlpGen (until interface package exist in LCG)
#============================================================================
macro alpgen_native_version "2.1.3d"


#-- Pythia 8
#============================================================================
macro pythia8_native_version "163"
macro_append pythia8_linkopts " -lhepmcinterface "
#set PYTHIA8DATA $(pythia8_home)/share/xmldoc


#-- Pythia 6
#============================================================================
macro pythia6_native_version "425.2"
use pythia6  v* LCG_GeneratorsInterfaces -no_auto_imports
macro_remove pythia6_linkopts " -lpythia6_pdfdummy " \
                        WIN32 " pythia6_pdfdummy.lib "

#-- Redefine symbols of MCGenerators libraries
#-- Pythia 6
#============================================================================
library      pythia6forgauss   pythia6/*.F

apply_pattern linker_library library=pythia6forgauss
macro_append pythia6forgauss_shlibflags "$(pythia6_home)/lib/pydata.o -lnsl -lcrypt -ldl -lg2c" \
             target-gcc4 "$(pythia6_home)/lib/pydata.o -lnsl -lcrypt -ldl"

## FIXME: Move to include of install area
##apply_pattern install_more_includes more=GENSER
include_dirs $(GENSERROOT)/src/pythia6   

# force the order of link for pythia6
macro_append GENSER_linkopts " $(pythia6_linkopts) "

#-- Photos
#============================================================================
library      photosforgauss   photos/*.F 

apply_pattern linker_library library=photosforgauss

# force the order of link for photos
macro_append GENSER_linkopts " $(photos_linkopts) "

#-- Hijing
#============================================================================
macro hijing_native_version "1.36.a.2"
use  hijing      v*  LCG_GeneratorsInterfaces    
macro         hijingforgaussSrc    " hijing/*.F "
macro_append  hijingforgaussSrc   "" \
                      Darwin       "-x=ran.F"
library      hijingforgauss   $(hijingforgaussSrc)

apply_pattern linker_library library=hijingforgauss
macro_append hijingforgauss_shlibflags "$(hijing_home)/lib/hidata.o $(hijing_home)/lib/pydata_hijing.o $(hijing_home)/lib/ludata_hijing.o"

# force the order of link for hijing
macro_append GENSER_linkopts " $(hijing_linkopts) "
macro_append hijing_linkopts " -lpythia_hijing "

#macro_prepend tauola++_linkopts "-Wl,--no-as-needed "
#macro_append tauola++_linkopts "-Wl,--as-needed "

#macro_prepend photos++_linkopts "-Wl,--no-as-needed "
#macro_append photos++_linkopts "-Wl,--as-needed "


private
macro_remove libraryshr_linkopts "-Wl,--no-undefined"

#-- linkopts
#============================================================================
public
macro GENSER_linkopts "-lnsl -lcrypt -ldl -lg2c" \
      target-gcc4     "-lnsl -lcrypt -ldl -lgfortran" \
      WIN32           "/LIBPATH:$(DFDir)\LIB DFORDLL.LIB DFPORT.LIB"


macro_prepend GENSER_linkopts " -Wl,--no-as-needed " \
              WIN32           ""
macro_append  GENSER_linkopts " -Wl,--as-needed " \
              WIN32           ""

macro_remove fflags "" \
      target-gcc4   "-ff90"

macro_append fflags "" \
      target-gcc4   " -fsecond-underscore "

# do not build on windows
#============================================================================
apply_pattern disable_package_on platform=target-winxp

