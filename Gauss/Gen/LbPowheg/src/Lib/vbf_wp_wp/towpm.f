       
      subroutine vbf_wp_wp_WPPTOWPP(q1,q2,p,ww)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+ w+ -> e+ ve mu+ vm  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=  33) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  36) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww(0:3,0:3)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      INTEGER NHEL(3:6), ihel
      DATA (NHEL(IHEL),IHEL=3,6) / +1,-1,-1,+1/
      Save NHEL
c  lepton spinors and W+- polarization vectors
      include 'src/Lib/vbf_wp_wp/tensorww.inc'

      logical lswitch
      parameter (lswitch=.true.)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
c
C ----------
C BEGIN CODE
C ----------
c read in lepton an W states from common block:
         do i=1,6
            w(i,3) = wel(i)
            w(i,4) = wve(i)
            w(i,5) = wmu(i)
            w(i,6) = wvu(i)
         enddo
c
      DO MU = 0,3
         DO NU = 0,3
      
      CALL vbf_wp_wp_vcartx(Q1(0),wMASS ,wwidth, MU,-1,W(1,1   ))        
      CALL vbf_wp_wp_vcartx(Q2(0),wMASS ,wwidth, NU,-1,W(1,2   )) 
               
      CALL vbf_wp_wp_fvixxx(W(1,3   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,7   ))    
      CALL vbf_wp_wp_jioxxx(W(1,7   ),W(1,4   ),GZN ,ZMASS   ,ZWIDTH  ,W(1,8   ))    
      CALL vbf_wp_wp_fvixxx(W(1,5   ),W(1,8   ),GZL ,ZERO    ,ZERO    ,W(1,9   ))    
      CALL vbf_wp_wp_iovxxx(W(1,9   ),W(1,6   ),W(1,1   ),GWF ,AMP(1   ))            
      CALL vbf_wp_wp_jvvxxx(W(1,8   ),W(1,1   ),GWWZ ,WMASS   ,WWIDTH  ,W(1,         
     &     10  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,6   ),W(1,10  ),GWF ,AMP(2   ))            
      CALL vbf_wp_wp_fvixxx(W(1,5   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,11  ))    
      CALL vbf_wp_wp_iovxxx(W(1,11  ),W(1,6   ),W(1,8   ),GZN ,AMP(3   ))            
      CALL vbf_wp_wp_fvoxxx(W(1,4   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,12  ))    
      CALL vbf_wp_wp_fvoxxx(W(1,6   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,13  ))    
      CALL vbf_wp_wp_jioxxx(W(1,3   ),W(1,12  ),GAL ,ZERO    ,ZERO    ,W(1,14  ))    
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,13  ),W(1,14  ),GAL ,AMP(4   ))            
      CALL vbf_wp_wp_jioxxx(W(1,3   ),W(1,12  ),GZL ,ZMASS   ,ZWIDTH  ,W(1,15  ))    
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,13  ),W(1,15  ),GZL ,AMP(5   ))            
      CALL vbf_wp_wp_jioxxx(W(1,5   ),W(1,6   ),GWF ,WMASS   ,WWIDTH  ,W(1,16  ))    
      CALL vbf_wp_wp_vvvxxx(W(1,2   ),W(1,16  ),W(1,14  ),GWWA ,AMP(6   ))           
      CALL vbf_wp_wp_vvvxxx(W(1,2   ),W(1,16  ),W(1,15  ),GWWZ ,AMP(7   ))           
      CALL vbf_wp_wp_fvixxx(W(1,5   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,17  ))    
      CALL vbf_wp_wp_jioxxx(W(1,17  ),W(1,6   ),GZN ,ZMASS   ,ZWIDTH  ,W(1,18  ))    
      CALL vbf_wp_wp_iovxxx(W(1,3   ),W(1,12  ),W(1,18  ),GZL ,AMP(8   ))            
      CALL vbf_wp_wp_jioxxx(W(1,7   ),W(1,12  ),GWF ,WMASS   ,WWIDTH  ,W(1,19  ))    
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,6   ),W(1,19  ),GWF ,AMP(9   ))            
      CALL vbf_wp_wp_fvoxxx(W(1,4   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,20  ))    
      CALL vbf_wp_wp_fvoxxx(W(1,6   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,21  ))    
      CALL vbf_wp_wp_jioxxx(W(1,3   ),W(1,20  ),GAL ,ZERO    ,ZERO    ,W(1,22  ))    
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,21  ),W(1,22  ),GAL ,AMP(10  ))            
      CALL vbf_wp_wp_jioxxx(W(1,3   ),W(1,20  ),GZL ,ZMASS   ,ZWIDTH  ,W(1,23  ))    
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,21  ),W(1,23  ),GZL ,AMP(11  ))            
      CALL vbf_wp_wp_vvvxxx(W(1,1   ),W(1,16  ),W(1,22  ),GWWA ,AMP(12  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,1   ),W(1,16  ),W(1,23  ),GWWZ ,AMP(13  ))           
      CALL vbf_wp_wp_jioxxx(W(1,11  ),W(1,6   ),GZN ,ZMASS   ,ZWIDTH  ,W(1,24  ))    
      CALL vbf_wp_wp_iovxxx(W(1,3   ),W(1,20  ),W(1,24  ),GZL ,AMP(14  ))            
      CALL vbf_wp_wp_fvixxx(W(1,3   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,25  ))    
      CALL vbf_wp_wp_jioxxx(W(1,25  ),W(1,4   ),GZN ,ZMASS   ,ZWIDTH  ,W(1,26  ))    
      CALL vbf_wp_wp_fvixxx(W(1,5   ),W(1,26  ),GZL ,ZERO    ,ZERO    ,W(1,27  ))    
      CALL vbf_wp_wp_iovxxx(W(1,27  ),W(1,6   ),W(1,2   ),GWF ,AMP(15  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,26  ),W(1,2   ),GWWZ ,WMASS   ,WWIDTH  ,W(1,         
     &     28  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,6   ),W(1,28  ),GWF ,AMP(16  ))            
      CALL vbf_wp_wp_iovxxx(W(1,17  ),W(1,6   ),W(1,26  ),GZN ,AMP(17  ))            
      CALL vbf_wp_wp_jioxxx(W(1,25  ),W(1,20  ),GWF ,WMASS   ,WWIDTH  ,W(1,29  ))    
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,6   ),W(1,29  ),GWF ,AMP(18  ))            
      CALL vbf_wp_wp_jioxxx(W(1,3   ),W(1,4   ),GWF ,WMASS   ,WWIDTH  ,W(1,30  ))    
      CALL vbf_wp_wp_jvvxxx(W(1,2   ),W(1,30  ),GWWA ,ZERO    ,ZERO    ,W(1,         
     &     31  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,21  ),W(1,31  ),GAL ,AMP(19  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,2   ),W(1,30  ),GWWZ ,ZMASS   ,ZWIDTH  ,W(1,         
     &     32  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,21  ),W(1,32  ),GZL ,AMP(20  ))            
      CALL vbf_wp_wp_iovxxx(W(1,11  ),W(1,13  ),W(1,30  ),GWF ,AMP(21  ))            
      CALL vbf_wp_wp_vvvxxx(W(1,1   ),W(1,16  ),W(1,31  ),GWWA ,AMP(22  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,1   ),W(1,16  ),W(1,32  ),GWWZ ,AMP(23  ))           
      CALL vbf_wp_wp_hvvxxx(W(1,2   ),W(1,30  ),GWWH ,HMASS   ,HWIDTH  ,W(1,         
     &     33  ))                                                          
      CALL vbf_wp_wp_vvsxxx(W(1,1   ),W(1,16  ),W(1,33  ),GWWH ,AMP(24  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,2   ),W(1,30  ),W(1,24  ),GWWZ ,AMP(25  ))           
      CALL vbf_wp_wp_iovxxx(W(1,17  ),W(1,21  ),W(1,30  ),GWF ,AMP(26  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,1   ),W(1,30  ),GWWA ,ZERO    ,ZERO    ,W(1,         
     &     34  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,13  ),W(1,34  ),GAL ,AMP(27  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,1   ),W(1,30  ),GWWZ ,ZMASS   ,ZWIDTH  ,W(1,         
     &     35  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,5   ),W(1,13  ),W(1,35  ),GZL ,AMP(28  ))            
      CALL vbf_wp_wp_vvvxxx(W(1,2   ),W(1,16  ),W(1,34  ),GWWA ,AMP(29  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,2   ),W(1,16  ),W(1,35  ),GWWZ ,AMP(30  ))           
      CALL vbf_wp_wp_hvvxxx(W(1,1   ),W(1,30  ),GWWH ,HMASS   ,HWIDTH  ,W(1,         
     &     36  ))                                                          
      CALL vbf_wp_wp_vvsxxx(W(1,2   ),W(1,16  ),W(1,36  ),GWWH ,AMP(31  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,1   ),W(1,30  ),W(1,18  ),GWWZ ,AMP(32  ))           
      CALL vbf_wp_wp_wwwwxx(W(1,1   ),W(1,30  ),W(1,2   ),W(1,16  ),GWWZ ,GWWA ,     
     &     AMP(33  ))                                                      
      ww(mu,nu)  = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)
          
      ENDDO
      enddo
      
      END
      
c **********************************************************************
   
      subroutine vbf_wp_wp_WMMTOWMM(q1,q2,p,ww)
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w- w- -> e- ve~ mu- vm~    
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS,    NEIGEN 
      PARAMETER (NGRAPHS=  33) 
      INTEGER    NWAVEFUNCS 
      PARAMETER (NWAVEFUNCS=  36) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS 
C  
      REAL*8 Q1(0:3), Q2(0:3), P(0:3,3:6)
      complex*16 ww(0:3,0:3)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS)
      INTEGER NHEL(3:6), ihel
      DATA (NHEL(IHEL),IHEL=3,6) / +1,-1,-1,+1/
      Save NHEL
c  lepton spinors and W+- polarization vectors
      include 'src/Lib/vbf_wp_wp/tensorww.inc'

      logical lswitch
      parameter (lswitch=.true.)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
c
C ----------
C BEGIN CODE
C ----------
c read in lepton an W states from common block:
         do i=1,6
            w(i,3) = wel(i)
            w(i,4) = wve(i)
            w(i,5) = wmu(i)
            w(i,6) = wvu(i)
         enddo

      DO MU = 0,3
         DO NU = 0,3
      
      CALL vbf_wp_wp_vcartx(Q1(0),wMASS ,wwidth, MU,-1,W(1,1   ))        
      CALL vbf_wp_wp_vcartx(Q2(0),wMASS ,wwidth, NU,-1,W(1,2   )) 
            
      CALL vbf_wp_wp_fvoxxx(W(1,3   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,7   ))    
      CALL vbf_wp_wp_jioxxx(W(1,4   ),W(1,7   ),GZN ,ZMASS   ,ZWIDTH  ,W(1,8   ))    
      CALL vbf_wp_wp_fvoxxx(W(1,5   ),W(1,8   ),GZL ,ZERO    ,ZERO    ,W(1,9   ))    
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,9   ),W(1,1   ),GWF ,AMP(1   ))            
      CALL vbf_wp_wp_jvvxxx(W(1,1   ),W(1,8   ),GWWZ ,WMASS   ,WWIDTH  ,W(1,         
     &     10  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,5   ),W(1,10  ),GWF ,AMP(2   ))            
      CALL vbf_wp_wp_fvoxxx(W(1,5   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,11  ))    
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,11  ),W(1,8   ),GZN ,AMP(3   ))            
      CALL vbf_wp_wp_fvixxx(W(1,4   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,12  ))    
      CALL vbf_wp_wp_fvixxx(W(1,6   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,13  ))    
      CALL vbf_wp_wp_jioxxx(W(1,12  ),W(1,3   ),GAL ,ZERO    ,ZERO    ,W(1,14  ))    
      CALL vbf_wp_wp_iovxxx(W(1,13  ),W(1,5   ),W(1,14  ),GAL ,AMP(4   ))            
      CALL vbf_wp_wp_jioxxx(W(1,12  ),W(1,3   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,15  ))    
      CALL vbf_wp_wp_iovxxx(W(1,13  ),W(1,5   ),W(1,15  ),GZL ,AMP(5   ))            
      CALL vbf_wp_wp_jioxxx(W(1,6   ),W(1,5   ),GWF ,WMASS   ,WWIDTH  ,W(1,16  ))    
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,2   ),W(1,14  ),GWWA ,AMP(6   ))           
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,2   ),W(1,15  ),GWWZ ,AMP(7   ))           
      CALL vbf_wp_wp_fvoxxx(W(1,5   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,17  ))    
      CALL vbf_wp_wp_jioxxx(W(1,6   ),W(1,17  ),GZN ,ZMASS   ,ZWIDTH  ,W(1,18  ))    
      CALL vbf_wp_wp_iovxxx(W(1,12  ),W(1,3   ),W(1,18  ),GZL ,AMP(8   ))            
      CALL vbf_wp_wp_jioxxx(W(1,12  ),W(1,7   ),GWF ,WMASS   ,WWIDTH  ,W(1,19  ))    
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,5   ),W(1,19  ),GWF ,AMP(9   ))            
      CALL vbf_wp_wp_fvixxx(W(1,4   ),W(1,2   ),GWF ,ZERO    ,ZERO    ,W(1,20  ))    
      CALL vbf_wp_wp_fvixxx(W(1,6   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,21  ))    
      CALL vbf_wp_wp_jioxxx(W(1,20  ),W(1,3   ),GAL ,ZERO    ,ZERO    ,W(1,22  ))    
      CALL vbf_wp_wp_iovxxx(W(1,21  ),W(1,5   ),W(1,22  ),GAL ,AMP(10  ))            
      CALL vbf_wp_wp_jioxxx(W(1,20  ),W(1,3   ),GZL ,ZMASS   ,ZWIDTH  ,W(1,23  ))    
      CALL vbf_wp_wp_iovxxx(W(1,21  ),W(1,5   ),W(1,23  ),GZL ,AMP(11  ))            
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,1   ),W(1,22  ),GWWA ,AMP(12  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,1   ),W(1,23  ),GWWZ ,AMP(13  ))           
      CALL vbf_wp_wp_jioxxx(W(1,6   ),W(1,11  ),GZN ,ZMASS   ,ZWIDTH  ,W(1,24  ))    
      CALL vbf_wp_wp_iovxxx(W(1,20  ),W(1,3   ),W(1,24  ),GZL ,AMP(14  ))            
      CALL vbf_wp_wp_fvoxxx(W(1,3   ),W(1,1   ),GWF ,ZERO    ,ZERO    ,W(1,25  ))    
      CALL vbf_wp_wp_jioxxx(W(1,4   ),W(1,25  ),GZN ,ZMASS   ,ZWIDTH  ,W(1,26  ))    
      CALL vbf_wp_wp_fvoxxx(W(1,5   ),W(1,26  ),GZL ,ZERO    ,ZERO    ,W(1,27  ))    
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,27  ),W(1,2   ),GWF ,AMP(15  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,2   ),W(1,26  ),GWWZ ,WMASS   ,WWIDTH  ,W(1,         
     &     28  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,5   ),W(1,28  ),GWF ,AMP(16  ))            
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,17  ),W(1,26  ),GZN ,AMP(17  ))            
      CALL vbf_wp_wp_jioxxx(W(1,20  ),W(1,25  ),GWF ,WMASS   ,WWIDTH  ,W(1,29  ))    
      CALL vbf_wp_wp_iovxxx(W(1,6   ),W(1,5   ),W(1,29  ),GWF ,AMP(18  ))            
      CALL vbf_wp_wp_jioxxx(W(1,4   ),W(1,3   ),GWF ,WMASS   ,WWIDTH  ,W(1,30  ))    
      CALL vbf_wp_wp_jvvxxx(W(1,30  ),W(1,2   ),GWWA ,ZERO    ,ZERO    ,W(1,         
     &     31  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,21  ),W(1,5   ),W(1,31  ),GAL ,AMP(19  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,30  ),W(1,2   ),GWWZ ,ZMASS   ,ZWIDTH  ,W(1,         
     &     32  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,21  ),W(1,5   ),W(1,32  ),GZL ,AMP(20  ))            
      CALL vbf_wp_wp_iovxxx(W(1,13  ),W(1,11  ),W(1,30  ),GWF ,AMP(21  ))            
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,1   ),W(1,31  ),GWWA ,AMP(22  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,1   ),W(1,32  ),GWWZ ,AMP(23  ))           
      CALL vbf_wp_wp_hvvxxx(W(1,30  ),W(1,2   ),GWWH ,HMASS   ,HWIDTH  ,W(1,         
     &     33  ))                                                          
      CALL vbf_wp_wp_vvsxxx(W(1,16  ),W(1,1   ),W(1,33  ),GWWH ,AMP(24  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,30  ),W(1,2   ),W(1,24  ),GWWZ ,AMP(25  ))           
      CALL vbf_wp_wp_iovxxx(W(1,21  ),W(1,17  ),W(1,30  ),GWF ,AMP(26  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,30  ),W(1,1   ),GWWA ,ZERO    ,ZERO    ,W(1,         
     &     34  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,13  ),W(1,5   ),W(1,34  ),GAL ,AMP(27  ))            
      CALL vbf_wp_wp_jvvxxx(W(1,30  ),W(1,1   ),GWWZ ,ZMASS   ,ZWIDTH  ,W(1,         
     &     35  ))                                                          
      CALL vbf_wp_wp_iovxxx(W(1,13  ),W(1,5   ),W(1,35  ),GZL ,AMP(28  ))            
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,2   ),W(1,34  ),GWWA ,AMP(29  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,16  ),W(1,2   ),W(1,35  ),GWWZ ,AMP(30  ))           
      CALL vbf_wp_wp_hvvxxx(W(1,30  ),W(1,1   ),GWWH ,HMASS   ,HWIDTH  ,W(1,         
     &     36  ))                                                          
      CALL vbf_wp_wp_vvsxxx(W(1,16  ),W(1,2   ),W(1,36  ),GWWH ,AMP(31  ))           
      CALL vbf_wp_wp_vvvxxx(W(1,30  ),W(1,1   ),W(1,18  ),GWWZ ,AMP(32  ))           
      CALL vbf_wp_wp_wwwwxx(W(1,30  ),W(1,1   ),W(1,16  ),W(1,2   ),GWWZ ,GWWA ,     
     &     AMP(33  ))                                                      
      ww(mu,nu) = +AMP(   1)+AMP(   2)+AMP(   3)+AMP(   4)+AMP(   5)
     &             +AMP(   6)+AMP(   7)+AMP(   8)+AMP(   9)+AMP(  10)
     &             +AMP(  11)+AMP(  12)+AMP(  13)+AMP(  14)+AMP(  15)
     &             +AMP(  16)+AMP(  17)+AMP(  18)+AMP(  19)+AMP(  20)
     &             +AMP(  21)+AMP(  22)+AMP(  23)+AMP(  24)+AMP(  25)
     &             +AMP(  26)+AMP(  27)+AMP(  28)+AMP(  29)+AMP(  30)
     &             +AMP(  31)+AMP(  32)+AMP(  33)
               
	enddo
	enddo
	
	end

c----------------------------------------------------------------

      subroutine vbf_wp_wp_WPVtoWP(idl,id,Q,v,wpa,wpz)
C  Input:   Q(*)        one of the two incoming boson momenta (t-channel)
c           id = 1      Q = q1 = W+ momentum 
c           id = 2      Q = q2 = gamma/Z momentum
c	    idl = 1	l,vu = e+,ve
c	    idl = 2	l,vu = mu+,vmu	
c	
c  OUPTPUT: wpa(mu,nu)  lepton tensor for w gamma--> l+nu
c           wpz(mu,nu)  lepton tensor for w Z    --> l+nu
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w+(q1) z(q2) -> l+ vl  
C FOR PROCESS : w+(q1) a(q2) -> l+ vl  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   3) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=   7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS
C
      integer id,idl
      real*8 q(0:3), v(0:3,4)
      complex*16 wpa(0:3,0:3), wpz(0:3,0:3)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 q2sq, Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS), denz
      complex*16 wwp(6),wl(6),wn(6)
c  lepton spinors and W+- polarization vectors
      include 'src/Lib/vbf_wp_wp/tensorww.inc'

      logical ldebug
      parameter (ldebug=.false.)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------

      if (idl.eq.1) then
         do i = 1,6
	    wwp(i) = we(i)
	    wl(i) = wel(i)
	    wn(i) = wve(i)
	 enddo      
      else
         do i = 1,6
	    wwp(i) = wu(i)
	    wl(i) = wmu(i)
	    wn(i) = wvu(i)
	 enddo            
      endif 
      
      if (id.eq.1) then
         q2(0) = dreal(wwp(5))
         q2(1) = dreal(wwp(6))
         q2(2) = dimag(wwp(6))
         q2(3) = dimag(wwp(5))
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = q2(mu)-q(mu)
         enddo
      elseif (id.eq.2) then
         q1(0) = dreal(wwp(5))
         q1(1) = dreal(wwp(6))
         q1(2) = dimag(wwp(6))
         q1(3) = dimag(wwp(5))
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = q1(mu)-q(mu)
         enddo
      endif
c
      do i=1,6                  ! read in lepton states from common block
         w(i,3) = wl(i)
         w(i,4) = wn(i)
	 w(i,7) = wwp(i)
      enddo

      q2sq = q2(0)**2-q2(1)**2-q2(2)**2-q2(3)**2
      denz = q2sq/dcmplx(q2sq-zmass**2,zmass*zwidth)
      DO MU = 0,3
         DO NU = 0,3
            CALL vbf_wp_wp_vcartx(Q1(0),WMASS ,Wwidth, MU,-1,W(1,1))        
            CALL vbf_wp_wp_vcartx(Q2(0),ZERO  ,ZERO  , NU,-1,W(1,2))
            CALL vbf_wp_wp_fvixxx(W(1,3),W(1,2),GZL ,ZERO,ZERO,W(1,5))    
            CALL vbf_wp_wp_iovxxx(W(1,5),W(1,4),W(1,1),GWF ,AMP(1))            
            CALL vbf_wp_wp_fvixxx(W(1,3),W(1,1),GWF ,ZERO,ZERO,W(1,6))    
            CALL vbf_wp_wp_iovxxx(W(1,6),W(1,4),W(1,2),GZN ,AMP(2))	                
            CALL vbf_wp_wp_vvvxxx(W(1,1),W(1,7),W(1,2),GWWZ ,AMP(3))            
            wpz(mu,nu) = (-AMP(   1)-AMP(   2)-AMP(   3))*denz
            wpa(mu,nu) = -(amp(1)*gal(1)/gzl(1)+amp(3)*gwwa/gwwz)
	    
         enddo
      enddo
 
      end

c----------------------------------------------------------------
       
      subroutine  vbf_wp_wp_WMVTOWM(idl,id,Q,v,wma,wmz)
c
C  Input:   Q(*)        one of the two incoming boson momenta (t-channel)
c           id = 1      Q = q1 = W- momentum 
c           id = 2      Q = q2 = gamma/Z momentum
c	    idl = 1	l,v~ = e-,ve~
c	    idl = 2	l,v~ = mu-,vm~	
c	
c  OUPTPUT: wma(mu,nu)  lepton tensor for w gamma--> l-nu~
c           wmz(mu,nu)  lepton tensor for w Z    --> l-nu~
C  
C  
C Generated by MadGraph II Version 3.0. Updated 02/19/04                
C RETURNS AMPLITUDE SQUARED SUMMED/AVG OVER COLORS
C FOR THE POINT WITH EXTERNAL LINES W(0:6,NEXTERNAL)
C  
C FOR PROCESS : w-(q1) z(q2) -> l- vl~ 
C FOR PROCESS : w-(q1) a(q2) -> l- vl~  
C  
      IMPLICIT NONE
C  
C CONSTANTS
C  
      INTEGER    NGRAPHS
      PARAMETER (NGRAPHS=   3) 
      INTEGER    NWAVEFUNCS
      PARAMETER (NWAVEFUNCS=   7) 
      REAL*8     ZERO
      PARAMETER (ZERO=0D0)
C  
C ARGUMENTS
C
      integer id,idl
      real*8 q(0:3), v(0:3,4)
      complex*16 wma(0:3,0:3), wmz(0:3,0:3)
C  
C LOCAL VARIABLES 
C  
      INTEGER I,J, MU, NU
      real*8 q2sq, Q1(0:3), Q2(0:3)
      COMPLEX*16 AMP(NGRAPHS)
      COMPLEX*16 W(6,NWAVEFUNCS), denz
      complex*16 wwm(6),wl(6),wn(6)
c  lepton spinors and W+- polarization vectors
      include 'src/Lib/vbf_wp_wp/tensorww.inc'

      logical ldebug
      parameter (ldebug=.false.)
C  
C GLOBAL VARIABLES
C  
      include "coupl.inc"
C                                                                          
C ----------
C BEGIN CODE
C ----------

      if (idl.eq.1) then
         do i = 1,6
	    wwm(i) = we(i)
	    wl(i) = wel(i)
	    wn(i) = wve(i)
	 enddo      
      else
         do i = 1,6
	    wwm(i) = wu(i)
	    wl(i) = wmu(i)
	    wn(i) = wvu(i)
	 enddo            
      endif 
      
      if (id.eq.1) then
         q2(0) = dreal(wwm(5))
         q2(1) = dreal(wwm(6))
         q2(2) = dimag(wwm(6))
         q2(3) = dimag(wwm(5))
         do mu = 0,3
            q1(mu) = q(mu)
            q2(mu) = q2(mu)-q(mu)
         enddo
      elseif (id.eq.2) then
         q1(0) = dreal(wwm(5))
         q1(1) = dreal(wwm(6))
         q1(2) = dimag(wwm(6))
         q1(3) = dimag(wwm(5))
         do mu = 0,3
            q2(mu) = q(mu)
            q1(mu) = q1(mu)-q(mu)
         enddo
      endif
c
      do i=1,6                  ! read in lepton states from common block
         w(i,3) = wl(i)
         w(i,4) = wn(i)
	 w(i,7) = wwm(i)
      enddo
            
	
      q2sq = q2(0)**2-q2(1)**2-q2(2)**2-q2(3)**2
      denz = q2sq/dcmplx(q2sq-zmass**2,zmass*zwidth)
      
      DO MU = 0,3
         DO NU = 0,3
            CALL vbf_wp_wp_vcartx(Q1(0),WMASS ,Wwidth, MU,-1,W(1,1))        
            CALL vbf_wp_wp_vcartx(Q2(0),ZERO  ,ZERO  , NU,-1,W(1,2))
	          
      	    CALL vbf_wp_wp_fvoxxx(W(1,3),W(1,2),GZL ,ZERO,ZERO,W(1,5))    
      	    CALL vbf_wp_wp_iovxxx(W(1,4),W(1,5),W(1,1),GWF ,AMP(1))  
	              
            CALL vbf_wp_wp_fvoxxx(W(1,3),W(1,1),GWF ,ZERO,ZERO,W(1,6))    
      	    CALL vbf_wp_wp_iovxxx(W(1,4),W(1,6),W(1,2),GZN ,AMP(2))          
      	    
	    CALL vbf_wp_wp_vvvxxx(W(1,1),W(1,7),W(1,2),GWWZ ,AMP(3))            
      
            wmz(mu,nu) = (+AMP(1)+AMP(2)-AMP(3))*denz
            wma(mu,nu) = (amp(1)*gal(1)/gzl(1)-amp(3)*gwwa/gwwz)

         enddo
      enddo
      
      end
