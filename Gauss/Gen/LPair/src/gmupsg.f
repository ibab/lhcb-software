*CMZ :  1.00/00 18/08/94  18.56.39  by  ZEUS Offline Group
*-- Author :    ZEUS Offline Group   18/08/94

      SUBROUTINE GMUPSG

*#**********************************************************************
*#
*#    SUBROUTINE GMUPSG
*#
*# PURPOSE: GET ALL BEAM AND CUT PARAMETER FROM SETGEN INPUT FILE
*#
*#
*# INPUT: SETGEN FILE  ; COMMON CUTS, BEAM, VEGPAR
*#
*# OUTPUT:
*#
*# CALLED BY: GMUBEG
*#
*# AUTHOR: OLAF DUENGER             CREATED AT: 92/02/05
*#
*# CHANGED BY:                              AT:
*# REASON:
*#
*#**********************************************************************

      IMPLICIT NONE

*KEEP,VEGPAR.
      INTEGER          NDIM,NCVG,ITMX,NPRN,IGRAPH,
     &                 NPOIN,NPRIN,NTREAT,IBEG,IEND
      COMMON /VEGPAR/  NDIM,NCVG,ITMX,NPRN,IGRAPH,
     &                 NPOIN,NPRIN,NTREAT,IBEG,IEND

*KEEP,BEAM.
      INTEGER          INTGE,INTGP,GPDF,SPDF,PMOD,EMOD,IPAIR,NQUARK
      REAL*8           INPE,INPP
      COMMON /BEAM/    INPE,INPP,INTGE,INTGP,GPDF,SPDF,PMOD,EMOD,
     &                 IPAIR,NQUARK

*KEEP,CUTS.
      INTEGER      MODCUT
      REAL*4       THMAX,THMIN,MXMN,MXMX,Q2MN,Q2MX
      REAL*8       COTTH1,COTTH2,ECUT,PTCUT,MXMIN2,MXMAX2,QP2MIN,QP2MAX
      COMMON /CUTS/COTTH1,COTTH2,ECUT,PTCUT,MXMIN2,MXMAX2,
     &             THMAX,THMIN,QP2MIN,QP2MAX,MODCUT,MXMN,MXMX,Q2MN,Q2MX

*KEND.

      INTEGER      LUN1,LUN2,LUN3,LUN4,LUN5
      COMMON/VGSAV/LUN1,LUN2,LUN3,LUN4,LUN5
      REAL EPSMAC,HINPE,HINPP,HTHMAX,HTHMIN,HECUT,HPTCUT
      INTEGER HMPDF,HMCUT,HEMOD,HPMOD,HIPAIR,I
      LOGICAL WRONG

C---Determine the machine accuacy EPSMAC (D= 2.E-06)
      EPSMAC = 0.5
      DO 33 I= 1, 100
      EPSMAC = EPSMAC * 0.5
      IF ((1.0+EPSMAC) .EQ. 1.0)  GO TO 35
   33 CONTINUE
      EPSMAC = 1.0E-6
   35 EPSMAC = 2.0 * EPSMAC

C--- READ BEAM PARAMETER FROM SETGEN INPUT FILE
      READ( LUN2,'(E16.3,E16.3,I2,I2,I2,I2)')
     &   HINPE,HINPP,HEMOD,HPMOD,HMPDF,HIPAIR

      WRONG=.FALSE.

C----- CHECKING BEAM PARAMETER
      IF (ABS(INPE-HINPE).GT. EPSMAC*(INPE+HINPE)) THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG INPE  : FILE INPE =',HINPE
      ENDIF
      IF (ABS(INPP-HINPP).GT. EPSMAC*(INPP+HINPP)) THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG INPP  : FILE INPP =',HINPP
      ENDIF
      IF (EMOD .NE. HEMOD) THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG EMOD  : FILE EMOD =',HEMOD
      ENDIF
      IF (PMOD .NE. HPMOD) THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG PMOD  : FILE PMOD =',HPMOD
      ENDIF
*      IF ((PMOD .GE. 100) .AND. (MPDF .NE. HMPDF)) THEN
*        WRONG=.TRUE.
*        WRITE(6,*)'SETGEN INPUT HAS WRONG MPDF  : FILE MPDF =',HMPDF
*      ENDIF
      IF (IPAIR .NE. HIPAIR) THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG PAIR  : FILE PAIR =',HIPAIR
      ENDIF

C--- READ CUT PARAMETER FROM SETGEN INPUT FILE
      READ( LUN2,'(I1,E16.3,E16.3,E16.3,E16.3)')
     &   HMCUT,HTHMAX,HTHMIN,HECUT,HPTCUT

C----- CHECKING CUT PARAMETER
      IF (MODCUT .NE. HMCUT) THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG MCUT : FILE MCUT =',HMCUT
      ENDIF
      IF ((MODCUT .EQ. 2) .AND.
     & (ABS(THMAX-HTHMAX).GT. EPSMAC*(THMAX+HTHMAX)))THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG THMX  : FILE THMX =',HTHMAX
      ENDIF
      IF ((MODCUT .EQ. 2) .AND.
     & (ABS(THMIN-HTHMIN).GT. EPSMAC*(THMIN+HTHMIN)))THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG THMN  : FILE THMN =',HTHMIN
      ENDIF
      IF ((MODCUT .EQ. 2) .AND.
     & (ABS(PTCUT-HPTCUT).GT. EPSMAC*(PTCUT+HPTCUT)))THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG PTCT  : FILE PTCT =',HPTCUT
      ENDIF
      IF ((MODCUT .EQ. 2) .AND.
     & (ABS(ECUT-HECUT).GT. EPSMAC*(ECUT+HECUT)))THEN
        WRONG=.TRUE.
        WRITE(6,*)'SETGEN INPUT HAS WRONG ECUT  : FILE ECUT =',HECUT
      ENDIF

      IF (WRONG) THEN
        WRITE(6,*)
     &    'SETGEN INPUT FILE HAS DIFFERENT PARAMETER; PROGRAM STOPS !!!'
        STOP
      ENDIF

      END
