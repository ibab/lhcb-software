! ====================================================================
! package Tools/CondDBUI
! package manager : Marco Clemencic
! ====================================================================

! 2015-06-23 - Marco Clemencic
 - Fixed a flow in the logic of CondDB.Admin.CompareDBToFiles.

! 2015-06-19 - Marco Clemencic
 - Added the CondDB.Admin.CompareDBToFiles function to check that
   CondDB.Admin.MakeDBFromFiles worked.

! 2015-06-04 - Liang Su
 - Add menu support for CALIBOFF

!========================= CondDBUI v3r34 2015-05-26 =========================
! 2015-05-26 - Liang Sun
 - A bug fix to enable the CondDBUI.CondDB member defaultTag so that an alternative tag can be used

! 2015-05-11 - Liang Sun
 - A bug fix for parsing release notes with SAX paser. The method within ReleaseNotesHandler is migrated into endElement() as you might expect an incomplete string within characters()

!========================= CondDBUI v3r33 2015-04-20 =========================
! 2015-03-04 - Liang Sun
 - Added writeDuplicate argument for method CondDB.storeXMLStringList() which is set to True be default. When writeDuplicate
   is set to False, there will be a check on whether the new & old payload contents are identical and only in the case of no
   the new payload contents are saved.

!========================= CondDBUI v3r32 2014-12-11 =========================
! 2014-12-05 - Liang Sun
 - The workaround for PyCoolCopy issue is now marked with FIXME. This is due to a current ROOT6 bug
    about handling exceptions in Python: https://sft.its.cern.ch/jira/browse/ROOT-5603

! 2014-12-05 - Liang Sun
 - PyCoolCopy().copy would not support a connection string as its target db when the target db does not exist,
    now use an empty cool.IDatabase object

!========================= CondDBUI v3r31 2014-10-14 =========================
! 2014-10-07 - Liang Sun
 - Added JIRA support when writing to release_notes.xml
 - Fixed a bug in script CondDBAdmin_GlobalTag.py

!========================= CondDBUI v3r30 2014-09-08 =========================
! 2014-09-03 - Marco Clemencic
 - Fixed build with ROOT 5 + CMT.

! 2014-08-27 - Liang Sun
 - Fixed a typo in Models.py which stops the program from getting IoVs

! 2014-08-06 - Liang Sun
 - Fixed a typo in ReleaseNotes.py

! 2014-07-30 - Liang Sun
 - More fixes on COOL API compatibility issues with ROOT 6, and additional exception handlings for COOL are added in the Helper.

! 2014-07-29 - Marco Clemencic
 - Ported to CMake the changes in the build (helper library etc.).

! 2014-07-24 - Liang Sun
 - Fixed the date in doc/release.notes

! 2014-07-24 - Liang Sun
 - Fixed COOL API compatibility issues with ROOT 6
 - Exception handlings for COOL added in Helpers by hand.
 - Admin/ReleaseNotes.py: lines altered to quell warning messages on coding convention during running

!========================= CondDBUI v3r29 2014-07-14 =========================
! 2014-07-11 - Marco Clemencic
 - Renamed dict/dictionary.h to avoid problems with ROOT 6.

! 2014-06-27 - Marco Clemencic
 - Fixed problem with a change in the API of COOL.

!========================= CondDBUI v3r28 2014-05-12 =========================
! 2014-03-26 - Liang Sun
 - Extend the support for tagging a new CondDB partition 'CALIBOFF'

!========================= CondDBUI v3r27 2014-02-17 =========================
! 2013-11-06 - Marco Clemencic
 - Use the new CondDBCompression Python binary module.

! 2013-09-30 - Marco Clemencic
 - Replaced PyCintex with cppyy.
   See https://sft.its.cern.ch/jira/browse/ROOT-154

! 2013-06-27 - Marco Clemencic
 - Replaced PyCintex with ROOT (preparing migration to ROOT 6).

! 2013-12-15 - Liang Sun
 - scripts/CondDBBrowser: Force the environment variable 'LC_ALL' to be 'C'

!========================= CondDBUI v3r26 2013-12-09 =========================
! 2013-12-02 - Liang Sun
 - __init__.py: Fixed a glitch of only translating strings from the 'data' key in the DB payload

!========================= CondDBUI v3r25 2013-09-30 =========================
! 2013-08-08 - Liang Sun
 - decompress_db_metadata.py: new script to decompress the content of a CondDB file.
    Still needed to keep a copy of uncompressed db files for backward compatibility.

!========================= CondDBUI v3r24 2013-07-17 =========================
! 2013-07-16 - Illya Shapoval
 - AriadneAdmin_InitialImport.py is made compliant with new Ariadne API, plus
   other minor changes.
 - Ariadne RecoType and SimType initial images (at doc/Ariadne/) are updated.

!========================= CondDBUI v3r23 2013-06-03 =========================
! 2013-05-13 - Liang Sun
 - __init__.py: Before any (de)compression operation, check the existence of the
   'data' key in the DB payload

!========================= CondDBUI v3r22 2013-04-29 =========================
! 2013-04-25 - Illya Shapoval
 - AriadneAdmin_InitialImport.py added:
   A script to perform an initial import of the LHCb compatibility relations
   between LHCb Software Projects, computing platforms, CondDB tags,
   reconstruction and simulation types and GRID sites.
 - recotypes_paths.txt, simtypes_paths.txt and sites.txt added:
   For the purpose of easy import of LHCb reconstruction and simulation types,
   and of the list of sites three special-format files are added to doc/Ariadne/.

! 2013-04-17 - Liang Sun
 - __init__.py: In the storeObject process, only do the compression if the
   compressed object is smaller in size.

! 2013-04-17 - Liang Sun
 - __init__.py, Browser/Models.py: Added support to read/write compressed databases.
   The compression/decompress processes work in the background without user intervention.

! 2013-03-14 - Liang Sun
 - compress_db_metadata.py, compress_db_metadata_mp.py: new scripts to compress
   the content of a CondDB file, both will yield exactly the same results. The
   later one is supposed to be much faster since it run concurrent tasks with
   multiprocessing

!========================= CondDBUI v3r21 2013-03-20 =========================
! 2013-02-20 - Illya Shapoval
 - ReleaseNotes.py: few handy methods added to fetch DataTypes from RN XML.

!========================= CondDBUI v3r20 2013-02-04 =========================
! 2012-12-04 - Illya Shapoval
 - _internals.py: DumpToFiles method now ignores the C++ exception ("Attempt
   to access data of NULL attribute "NODE_PARENTID"") which prevented dumping
   local tags from SQLite to XML files in some cases(*). The ignorance is safe,
   but a more deep fix is needed in COOL.

   (*) This happened when a local tag (not it's auto-childs) was bound to
   the most common folderset level being NOT the '/' root folderset.

!========================= CondDBUI v3r19 2012-11-26 =========================
! 2012-11-15 - Marco Clemencic
 - Added CMake configuration file.

! 2012-10-25 - Liang Sun
 - Making flow cotrol file ".stopUpdatingSnapshots" able to stop the update
   process on ONLINE snapshots for the CondDB_UpdateOnlineSnapshots.py script.

!========================= CondDBUI v3r18 2012-09-28 =========================
! 2012-09-13 - Marco Clemencic
 - Removed dependencies on CORAL LFCReplicaSvc (dropped in LCGCMT 64).
   Note: the script CreateDBLookupFiles.py should be removed.

!========================= CondDBUI v3r17 2012-07-30 =========================
! 2012-07-24 - Illya Shapoval
 - CondDBAdmin_Commit.py and CondDBAdmin_GlobalTag.py:
   Switching the release_notes.xml location detection from using SQLDDDBROOT to
   SQLITEDBPATH environment variable. This is needed to accommodate the Upgrade
   CondDB use case.

!========================= CondDBUI v3r16 2012-07-24 =========================
! 2012-07-16 - Illya Shapoval
 - CondDB_UpdateOnlineSnapshots.py:
   an improvement to better isolate concurrent ONLINE update processes from each
   other running on the same destination.

!========================= CondDBUI v3r15 2012-06-25 =========================
! 2012-06-12 - Illya Shapoval
 - TagsFilter.py: A method added to Release Notes Handler to get all local tags
   for specific data type and partition.

!========================= CondDBUI v3r14 2012-03-26 =========================
! 2012-03-22 - Illya Shapoval
 - CondDBAdmin_DQ_Commit.py:
   Add patch id to the release notes DQ entry.
 - CondDBAdmin_GlobalTag.py:
   Extend the number of available partitions with DQFLAGS.

!========================= CondDBUI v3r13 2011-12-14 =========================
! 2011-11-17 - Illya Shapoval
 - The commitment machinery now states a fact of a new nodes insertion to the db
   in the release notes web page (xsd&xsl were also changed to visualize this).

! 2011-11-15 - Illya Shapoval
 - Minor options changes for the TSDBAdmin_Commit.py script.

!========================= CondDBUI v3r12 2011-11-07 =========================
! 2011-09-26 - Illya Shapoval
 - ONLINE snapshot replacement in 'CondDB_UpdateOnlineSnapshots.py' is made atomic.

!========================= CondDBUI v3r11 2011-08-30 =========================
! 2011-08-19 - Illya Shapoval
 - 'CondDBUI/Browser/MainWindow.py':
   + Fixed deprecation warning as of python 2.6 on obsolete 'BaseException.message'.
   + The 'selectedPath' slot is fixed to ignore an empty path. An exception was
   raised every time the new database is opened while keeping some path selected
   in the hierarchy of the previous database view.

! 2011-08-16 - Illya Shapoval
 - 'CondDB_UpdateOnlineSnapshots.py' is prepared for automatic cron-running and
   polished a bit (now compatible with Python 3.*).

!========================= CondDBUI v3r10 2011-06-14 =========================
! 2011-06-14 - Illya Shapoval
 - TagsFilter.py is updated:
   + 'BookkeepingSystem' module is changed to 'NewBookkeepingSystem' one;
   + SQLDDDBROOT environment variable is changed to the SQLITEDBPATH one
   (latter is set in the SQLDDDB package). This is needed in the frame of
   new optimized CondDB files distribution model.

!========================= CondDBUI v3r9 2011-04-04 =========================
! 2011-03-03 - Illya Shapoval
 - CondDB.getTagList method is parallelized (using Python multiprocessing).
   That was needed since sequential tags extraction for almost all nodes
   had become very time consuming, e.g. in the CondDBBrowser (up to 40s).

!========================= CondDBUI v3r8 2011-01-31 =========================
! 2011-01-31 - Illya Shapoval
 - Minor bug fix in 'CondDB_UpdateOnlineSnapshots.py' script.

! 2011-01-28 - Illya Shapoval
 - 'CondDBAdmin_DQ_Commit.py' script added. It (de)populates DQFLAGS database
   with DQ Flags in a specified IOV and updates SQLDDDB Release Notes web page.

! 2011-01-16 - Illya Shapoval
 - TagStatusDB.getGoodTags method is modified to take into account tag
   visibility time boundary.

! 2011-01-10 - Illya Shapoval
 - 'CondDB_UpdateOnlineSnapshots.py' script added, which updates SQLDDDB ONLINE
   snapshots. It detects used time scheme (per-year or per-month) of ONLINE
   snapshots and updates them to extend their coverage up to current time.
   If no ONLINE snapshots are found it will generate them from scratch.
   It updates also user's SQLDDDB release notes accordingly.

!========================= CondDBUI v3r7 2010-12-15 =========================
! 2010-12-15 - Illya Shapoval
 - TSDB scheme is extended to be more generic (all classes machninery is
   modified accordingly). A lot of tune up to start automatization of the TSDB
   monitoring system.

! 2010-12-13 - Illya Shapoval
 - Further improvements for TagStatus monitoring system.

! 2010-12-08 - Illya Shapoval
 - Added two new scripts and TSDB backup table scheme:
   + scripts/TSDBAdmin_Commit.py:
   Is meant for insertion of new global tag entry with all its statuses at all
   Tier 1s.
   + scripts/TSDBAdmin_Update.py:
   Performs update of current tag with new status for particular Tier 1.
 - Other five scripts and modules are tuned up for actual install area env.

!========================= CondDBUI v3r6 2010-11-27 =========================
! 2010-11-19 - Illya Shapoval
 - Added 5 new scripts:
   + "TagStatusDB.py":
   New clases to interact with the TagStatus database designed to monitor
   the CondDB global tag availability status at Tier1's level.
   + "CondDBAdmin_HashTag.py":
   generates master hash sums for global tags and places it to release_notes.xml
   to be used then to fill TagStatusDB.
   + "TSDBAdmin_MasterAgent.py":
   explaines to Tier script agents what validity status do global tags have at
   particular Tier talking to SQLite TagStatus database.
   + "TSDBAdmin_MasterAgent.cgi":
   wrapper to the script above to set its environment at the web server.
   + "TSDBAdmin_TierAgent.py":
   requests "TSDBAdmin_MasterAgent.py" at the web server to understand current
   status of all global tags at Tier where this agent lives. Also checks
   whether invalid tags became valid and redirects these candidates to a
   commit manager to update TagStatusDB.
 - Added 'pytools' dependency to use 'Storm' interface.

! 2010-11-17 - Illya Shapoval
 - Added new CondDB.payloadToHash method to calculate any kind of hash sum for
   a node making the old CondDB.payloadToMd5 method its special case.
   In addition the bug is fixed in this machinery to reslove requested tag
   existence at particluar folder node before its hashing.
 - Added new methods ReleaseNotes.addHashToGlobalTag and
   ReleaseNotes.getGlobalTags (all global tags for requested partition).
 - Added new script to compare two databases versioned with a tag of interest.
   Can be used to verify full equivalence (not just presence) of the tags at
   Tier 1s and at master DB.
 - CondDBAdmin_GlobalTag.py sript is upgraded to calculate and add hash sum
   to 'release_notes.xml' for a global tag when tagging is done.

! 2010-11-12 - Marco Clemencic
 - Added the possibility of specifying extra option files to CondDBBrowser
   (used to provide the list of "standard" databases).
 - Added VetraCondDB.py to the default list of option files to import by
   default. (fixes bug #73085)

!========================= CondDBUI v3r5p1 2010-10-25 =========================

! 2010-10-07 - Marco Clemencic
 - Replaced the usage of module md5 (deprecated since Python 2.6) with hashlib
   (prevent deprecation warning).

!===================== Tools/CondDBUI v3r5 2010-08-25 =========================
! 2010-08-13 - Illya Shapoval
 - The bug is fixed (see Savannah bug #53126) in CondDBUI.PyCoolDiff which
   prevented insertion of new object if its payload at its IOV-'since' value is
   equal to the current actual payload. The harmfull side effect of this was
   that all other IOVs with different payloads which had had to be covered by
   the new IOV remained actual. Now diffing machinery ignores new objects only
   if new IOV covers only *one* old IOV which has the *same* as new payload.

                            NEEDS LCGCMT >= 58d (Gaudi v21r10)
! 2010-07-20 - Marco Clemencic
 - Use pygraphics + Qt instead of pyqt (new schema in LCGCMT).

!===================== Tools/CondDBUI v3r4 2010-05-21 =========================
! 2010-05-19 - Illya Shapoval
 - Added CreateDBLookupFile.py script which generates the full set of files with
   CondDB Tier-1s connection settings (authentication.xml and dblookup-SITE.xml).
   Currently these files are located in AppConfig/conddb.
 - TagsFilter.py script is upgraded. Now it can insert into bookkeeping db the
   names of global tags marked with 'BK' data type in SQLDDDB release notes file.

!===================== Tools/CondDBUI v3r3 2010-03-24 =========================
! 2010-03-24 - Illya Shapoval
 - Removed pyqt_compat dependency which was the reason for CondDBBrowser
   segfaults when working with the Oracle Online partition.

! 2010-03-16 - Marco Clemencic
 - Modified the Python module CondDBUI to require PyCool at run-time only for
   the functions that really need it.
   It allows to use the other utilities (like the tag filters) without PyCool.

! 2010-03-02 - Illya Shapoval
 - Fixed the bug in database diffing and merging procedures to correctly process
   cases with multiple payloads.

!===================== Tools/CondDBUI v3r2 2010-02-14 =========================
! 2010-02-03 - Marco Clemencic
 - Correctly fixed the bug in CondDBBrowser: cannot add conditions to empty
   folders.

! 2010-01-31 - Illya Shapoval
 - Some upgrade of tools in the frame of creation the automation procedure
   for the latest global tag and appropriate on-top local tags usage.
   Particularly:
   ReleaseNotes class is modified to attach the 'type' elements to global and
   local tags entries in the release_notes.xml file when processing patches.
   Also corresponding changes were introduced into the CondDBAdmin_Commit.py
   and CondDBAdmin_Global_Tag.py scripts. See help for right options usage.

! 2010-01-29 - Illya Shapoval
 - TagsFilter.py script adapted to the changes in the release_notes.xml structure.
   Fixed some minor bugs.

! 2010-01-28 - Illya Shapoval
 - Added python/CondDBUI/Admin/TagsFilter.py script. It analyses the
   release_notes.xml file (under the given condition of fixed partition name
   and data type) to return:
   - the most recent global tag and the list of all subsequent local tags for it;
   - the list of all global tags.
   Can be used as a standalone script.

!===================== Tools/CondDBUI v3r1 2010-01-20 =========================
! 2010-01-12 - Marco Clemencic
 - Fixed a minor bug in CondDBBrowser: it was not possible to add conditions to
   empty folders.

!===================== Tools/CondDBUI v3r0 2009-12-11 =========================
! 2009-12-08 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser
   - added "delete tag" feature
   - minor usability improvements
   - completely covered the functionalities of the old browser
   - fixed a problem with the conversion between ValidityKey and QDateTime
     on 32 bits platforms
   - added automatic support for PIT environment

! 2009-12-07 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser
   - added the "New tag" feature
   - added the script to call the new browser (also .bat)
   - renamed the old script to CondDBBrowserOld.py
   - added a welcome message for the first time
   - various improvements

! 2009-12-06 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser
   - added the "Create slice" feature
   - added a menu entry to copy the connection string of the current database to
     the clipboard
   - minor fixes and improvements

! 2009-12-02 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser.
   - completed the "add condition" feature (only few missing bits)
   - minor fixes and improvements

! 2009-12-01 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser.
   - added a find dialog to search inside the condition text
   - added a small help for the add condition dialog
   - added the possibility to switch to/from fixed width fonts in the central widget

! 2009-11-30 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser.
   - started the dialog for new conditions
   - minor improvements
   - replaced the splitter with dock widgets

! 2009-11-08 - Marco Clemencic
 - Improvements to the new Qt4-based CondDBBrowser.

! 2009-11-03 - Marco Clemencic
 - Fixed a compilation problem on Windows for the dictionary.

! 2009-11-02 - Marco Clemencic
 - Added a helper function for python with its dictionary (as a work-around for
   a problem with dictionaries of std::map in CondDBUI.Browser).
 - Changes in CondDBUI.Browser:
   - added the list of recently opened COOL connection strings
   - store settings using QSettings

!===================== Tools/CondDBUI v2r23 2009-10-16 ========================
! 2009-09-14 - Illya Shapoval
 - The script for adding the global tag to the db is unified to standard
   CondDBUI form and functionality, and added to the CondDBUI package as
   CondDBAdmin_GlobalTag.py.

! 2009-09-09 - Illya Shapoval
 - Fixed the bug in an analysis method of the ReleaseNotes class for dealing with
   release_notes.xml content.

!===================== Tools/CondDBUI v2r22 2009-09-03 ========================
! 2009-09-01 - Illya Shapoval
 - Modified function in ReleaseNotes class for local tag homogeneity case
   detection in the release_notes.xml file.
 - Modified addNote function to contain functionality for merging homogeneous
   local tags entries in the release_notes.xml file.
 - Improved addGlobalTag function.

! 2009-08-03 - Illya Shapoval
 - Added function to ReleaseNotes class for global tag homogeneity case detection
   in the release_notes.xml file.
 - Modified addGlobalTag function to contain functionality for merging
   homogeneous global tags entries in the release_notes.xml file.

!===================== Tools/CondDBUI v2r21 2009-07-28 ========================
! 2009-07-21 - Marco Clemencic
 - Improved the fragments for pyqt.

! 2009-07-20 - Marco Clemencic
 - Modified the new CondDBBrowser to work with zipped Python directories (needed
   starting from Gaudi v21r4).
 - Added fragment to convert the Qt Designer .ui files to Python modules.

!===================== Tools/CondDBUI v2r20 2009-07-14 ========================
! 2009-06-30 - Marco Clemencic
 - Improvements to the new CondDBBrowser:
   - better look of the list of IoVs
   - cache the tags of the already viewed folder to improve responsiveness

!===================== Tools/CondDBUI v2r19 2009-06-30 ========================
! 2009-06-30 - Marco Clemencic
 - Merged (some of) the functionalities fo dump_db_to_files.py into
   CondDBAdmin_MakeSnapshot.py, for a simpler user interface. The old script is
   kept until the merge will be completed (if it will be completed).

! 2009-06-30 - Wouter Hulsbergen
 - Modified copy_files_to_db.py to be able to specify an interval of validity for
   the new data.

! 2009-06-20 - Marco Clemencic
 - Essentially completed the "browsing" part of the CondDBBrowser.

! 2009-06-16 - Marco Clemencic
 - Fixed a problem with user specified options in CondDBAdmin_MakeSnapshot.py
 - Changes in the prototype for the new CondDBBrowser:
   - added a CMT fragment to generate PyQt resource modules (to be moved to LCGCMT)
   - moved the resources to a dedicated directory and added a .qrc file
   - re-implemented the CondDBStructureModel to take into account channels

!===================== Tools/CondDBUI v2r18 2009-05-25 ========================
! 2009-05-22 - Marco Clemencic
 - Ported the CondDBBrowser to PyQt4 using the pyqt_compat package (which
   privides the Qt3Support module).
   Note: there are a couple of bugs in the pyqt_compat package distributed with
   LCGCMT 56a (work-around added here).

! 2009-05-12 - Marco Clemencic
 - Added the function CondDBUI.Admin.ReleaseNotes.addGlobalTag.

!===================== Tools/CondDBUI v2r17 2009-05-07 ========================
! 2009-03-30 - Marco Clemencic
 - Allow multi-line release notes comments in CondDBAdmin_Commit.py.

!===================== Tools/CondDBUI v2r16 2009-02-18 ========================
! 2009-02-12 - Marco Clemencic
 - Fix in CondDBAdmin_MakeSnapshot.py to be able to use LFC-based authentication
   for the connection (not directly supported by PyCoolCopy).

! 2009-02-09 - Marco Clemencic
 - Modified dump_db_to_files.py to make the reference to /Conditions/Online
   always point to the database.

!===================== Tools/CondDBUI v2r15 2009-01-08 ========================
! 2009-01-06 - Marco Clemencic
 - Added support for savannah patches in release_notes.xs[ld] to
   CondDBUI.Admin.ReleaseNotes and CondDBAdmin_Commit.py.

!===================== Tools/CondDBUI v2r14 2008-11-17 ========================
! 2008-11-14 - Marco Clemencic
 - Fixed some python code that was using obsolete functions.

! 2008-11-13 - Marco Clemencic
 - Added a work-around to dump_db_to_files.py to support system entities like
   "conddb:DTD/structure.dtd".

!===================== Tools/CondDBUI v2r13 2008-09-30 ========================
! 2008-09-26 - Marco Clemencic
 - Modified PyCoolDiff to truncate the IOVs to the selection range when writing
   to the output database.
 - Moved time related functions from MakeSnapshot to _internals.
 - Extended CondDBAdmin_Commit to accept an IOV for the conditions to insert.

!===================== Tools/CondDBUI v2r12 2008-07-30 ========================
! 2008-07-30 - Marco Clemencic
 - Changed the name of the configurables for online partition from ONLINE-YYYYMM
   to ONLINE_YYYYMM.

! 2008-07-28 - Marco Clemencic
 - Work around for a problem with the LCG interface package for sip (affecting
   the distributed version of LCG 55a).
 - Minor fixes in CondDBUI.Management (CondDBAdmin_Commit.py).

! 2008-07-23 - Marco Clemencic
 - Added the connection string to the opened database in the status bar of
   CondDBBrowser.py.
 - Bug-fixes in CondDBAdmin_Commit.py and PyCoolDiff to support local tags.

! 2008-07-22 - Marco Clemencic
 - Modified CondDBAdmin_MakeSnapshot.py to accept interval of validity as UTC.
 - Allow ONLINE-YYYYMM as partition alias in CondDBBrowser.py and
   CondDBAdmin_MakeSnapshot.py.

!===================== Tools/CondDBUI v2r11 2008-07-16 ========================
! 2008-07-16 - Marco Clemencic
 - Minor esthetic improvements.
 - Added method CondDB.isMultiVersionFolder.

! 2008-07-14 - Marco Clemencic
 - Minor improvements (documentation) to CondDBAdmin_Commit.py and
   CondDBAdmin_MakeSnapshot.py.

! 2008-07-10 - Marco Clemencic
 - Removed some obsolete files:
   - cmt/dblookup.xml
   - scripts/create_SQLDDDB.py
 - Converted the python module CondDBUI.Admin to a module with sub-modules
 - Added the scripts
   - CondDBAdmin_Commit.py: takes user-provided patches and apply them to
       official database.
   - CondDBAdmin_MakeSnapshot.py: simple script to make CondDB snapshots.
 - Added the script CondDBAdmin_Commit.py, which takes user-provided patches
   and apply them to official database.
 - Modify CondDBBrowser.py to accept on the command line the name of a CondDB
   partition and open the corresponding database (guessed from SQLDDDB options)
 - Minor improvements in other scripts

!===================== Tools/CondDBUI v2r10 2008-06-30 ========================
! 2008-06-26 - Marco Clemencic
 - Adapted to work with the new SEAL-less COOL and CORAL too.
   (Only for the LFCReplicaService)

!===================== Tools/CondDBUI v2r9 2008-04-18 =========================
! 2008-04-17 - Marco Clemencic
 - Preliminary support for dump of the DB image to files based option files.
 - Fix for usage of channel IDs (to/from DB).

!===================== Tools/CondDBUI v2r8 2008-02-22 =========================
! 2008-02-21 - Marco Clemencic
 - Added few member functions to CondDB:
   + moveTagOnLocalTag
     Move a tag to encompass the changes identified by another tag
   + resolveTag
     Return the local tag for a parent tag, or None if there is not relation
   + findNodesWithTag
     Return the list of folders (or foldersets) in which the local tag is
     defined.

!===================== Tools/CondDBUI v2r7 2008-01-28 =========================
! 2008-01-23 - Marco Clemencic
 - Added a the sub-module CondDBUI.Admin for functions needed for administrative
   tasks. Currently it contains:
    - check_addition_db_content:
      checks if the database we are going to merge into another one contains
      only files which are not yet there
    - merge_and_tag:
      insert the content of a database into another one (after calling
      'check_addition_db_content') and apply a tag to the new files (move it if
      it already exists)

! 2008-01-08 - Marco Clemencic
 - Fixed a problem with local tags in dump_db_to_files.py.

! 2008-01-07 - Marco Clemencic
 - Fixed a bug preventing to open a database.

! 2007-12-20 - Marco Clemencic
 - Added the possibility to specify a connection string on the command line of
   CondDBBrowser.py to open a database.

! 2007-12-14 - Marco Clemencic
 - Fixed a bug (introduced with the latest changes) that prevents the addition
   of new conditions.

!===================== Tools/CondDBUI v2r6 2007-12-07 =========================
                            NEEDS LCGCMT >= 53f (Gaudi v19r6)
! 2007-12-07 - Marco Clemencic
 - Use pyqt from LCG_Interfaces without hacks.
 - Restructured the package to use the installation of python modules and
   scripts as in Gaudi
   - the main module is now CondDBUI
   - the browser is now CondDBBrowser.py
 - Changes in CondDBUI:
   - Added the methods cloneTag and moveTagOnNodes to CondDBUI.CondDB.
   - CondDB connection string can now contain environment variables.
 - Changes in the browser
   - Modified the way configuration and settings are stored.
   - Added default entries for the official databases.
 - Added 2 small scripts that wrap the merge and diff functions in CondDBUI
   (merge_db.py and diff_db.py).

! 2007-12-07 - Kurt Rinnert
 - Fixed a problem with ValidityKeyWrapper.__eq__

                            NEEDS LCGCMT >= 53c (Gaudi v19r5)
! 2007-10-03 - Marco Clemencic
 - Use pyqt from LCG_Interfaces. It still needs a small hack because of a
   problem with PyQt v3 installation.

!===================== Tools/CondDBUI v2r5 2007-09-04 =========================
! 2007-08-21 - Marco Clemencic
 - Fixed 2 bugs in the browser
   - Check if the environment variable CORAL_DBLOOKUP_PATH exists before using
     it.
   - Work around for a problem with the character encoding. Qt uses UTF, while
     we have to use ISO-8859-1 in the database.

!===================== Tools/CondDBUI v2r4 2007-07-05 =========================
! 2007-07-05 - Marco Clemencic
 - Added a script to dump a database snapshot to XML files:
     dump_db_to_files.py.
   The user can/should provide a tag and the "event time" (as nanoseconds).

! 2007-06-28 - Marco Clemencic
 - Fixed the local copy of PyCoolDiff
 - Added a wrapper for PyCoolCopy.copy to support LFCReplicaSvc
 - Added the function conddbui.merge to copy the content of a database
   into another (where folders already exist). It is needed to merge the
   database obtained with PyCoolDiff.diff into the master database.
 - Made PyCoolDiff working also when the provided tag is not valid for all the
   folders
 - Added the utility function CondDB.getCOOLNode to retrieve a IFolder or
   IFolderSet object from the database without having to check the type of the
   requested node.

!===================== Tools/CondDBUI v2r3 2007-06-15 =========================
                            NEEDS LCGCMT >= 52
! 2007-06-06 - Marco Clemencic
 - Fixed a problem in copy_files_to_db.py: the destination path was not taken
   into account when correcting the relative paths to included files (SYSTEM
   tag)

! 2007-06-04 - Marco Clemencic
 - Allow transparent usage of CORAL LFCReplicaService (enabled if the
   environment variable CORAL_LFC_BASEDIR is set).
 - Use Qt from LCG_Interfaces

!===================== Tools/CondDBUI v2r2 2007-04-23 =========================
! 2007-03-30 - Marco Clemencic
 - Fixed a bug in the requirements: it was still depending on SQLDDDB v*.
   (now it should be DDDB)
 - Made it possible to pass to copy_files_to_db.py files with system ids
   starting with "conddb:" without breaking them.

!===================== Tools/CondDBUI v2r1 2007-03-20 =========================
! 2007-03-12 - Marco Clemencic
 - Fixed a small bug when trying to find the tags of a folder.
   If one of the tags in and ancestor folderset does not have a correspondent
   in the folder, COOL throws na exception that was not properly handled.

!===================== Tools/CondDBUI v2r0 2007-03-07 =========================
                            NEEDS LCGCMT >= 50

! 2007-03-06 - Marco Clemencic
 - Changed the path to the sessions database to
   "$HOME/.conddb_browser_sessions.dbm"
 - Use ISO date-time format (yyyy-mm-dd HH:MM:SS.S) for the validity key.

! 2007-02-28 - Marco Clemencic
 - Clean up in requirements (depend on Det/SQLDDDB)
 - Improved the scripts to create the SQLite (SQLDDDB) database from CVS

! 2007-02-20 - Marco Clemencic
 - bug-fix in create_SQLDDDB.py
 - added the script to check if a tag is available (checktag.py)

! 2007-02-19 - Marco Clemencic
 - Moved the script to generate SQLDDDB from Det/SQLDDDB to CondDBUI:
      python/create_SQLDDDB.py
   (Det/SQLDDDB does not depend anymore on CondDBUI)

! 2007-02-18 - Marco Clemencic
 - Few updates by Anatoly

! 2007-02-17 - Marco Clemencic
 - Moved all the dependencies (8and environment variables) needed by the
   browser to the private section to avoid unwanted dependencies.
   The dependencies to import the module conddbui are in the public with
   -no_auto_imports
 - Commented out Oracle and MySQL dependencies
 - Typo fixed in conddbui.py
 - Added copy_files_to_db_wiht_time.py:
   version of copy_files_to_db that inserts randomly generated IOVs
   (contribution by Anatoly Solomin)

! 2007-02-16 - Marco Clemencic
 - Some clean up in the requirements
 - Some more comments in copy_files_to_db.py

! 2007-02-15 - Marco Clemencic
 - Few bug-fixes in tag-handling.

! 2007-02-14 - Marco Clemencic
 - Updated to COOL_2_0_0.
 - Small changes in the GUI
 - Added the possibility to open emacs to edit the condition
 - Improvements to copy_files_to_db (core moved to conddbui)
 - Moved conddbui tests to a different python script
 - Some clean up in the documentation
 - Added a python function to compute differences between two DBs
   (this is temporary because it will appear in COOL)

!=========== Tools/CondDBUI v1r1 2007-02-01 ===================================
! 2007-02-01 - Marco Clemencic
 - Added use of CLHEP because of a bug in PyCintex.

! 2007-01-30 - Marco Clemencic
 - SQLite connection string changed back to the old one because the new one is
   supported only by COOL 2.x

! 2007-01-24 - Marco Clemencic
 - Changed the SQLite connection string.

! 2006-12-21 - Marco Clemencic
 - Added a function to change the encoding of XML files to ISO-8895-1 before
   storing them (it is the default encoding on Oracle at CERN).
 - Added alias CondDBBrowser

! 2006-11-06 - Marco Clemencic
 - Minor cosmetic changes
 - Add the function CondDB.isTagReady to check the availability of a tag for a
   given node (folder or folder-set).

!=========== Tools/CondDBUI v1r0 2006-09-29 ===================================
! 2006-09-29 - Nicolas Gilardi
 - Changed the browser's "Super User" menu into an "Advanced" menu with
   "New Node", "Delete Node" and "Delete Tag" actions. This menu is always
   available for databases opened in Read/Write mode. The "Delete Database"
   action has been commented out for now.
 - Cleaned up the requirement file.

! 2006-09-28 - Nicolas Gilardi
 - fixed a bug in guidialog.addConditionDialog which was preventing to reload
   correctly the payload of the selected object in the stack.
 - fixed a small bug in guidialog.addConditionDialog, which was displaying an
   error when trying to reload objects from an empty list.
 - modified the default selection behaviour of the addConditionDialog stack.
   Now default selection is on the last element of the stack, not the first
   one.
 - tried to fix the issue of default payload key selection in
   addConditionDialog but did not succeed so far.
 - tried to fix the "modal" behaviour of guidialog.conditionEditorDialog when
   opened from addConditionDialog, but did not succeed.

! 2006-09-27 - Nicolas Gilardi
 - fixed a small bug in guiwin.createDBSlice related to the changes in
   PyCoolCopy module new import "strategy".

! 2006-09-25 - Nicolas Gilardi - Marco Clemencic
 - Modified CondDB.payloadToMD5 to be compatible with multiple payload keys.
 - Fixed a bug in CondDB.payloadToMD5 which was preventing to retrieve data for
   non HEAD tags.
 - Fixed a compatibility problem with the PyCoolCopy version provided with
   COOL 1.3.2 version, which does not have the "append" function. The conddbui
   package now imports the full PyCoolCopy package. The "Append" button in the
   browser's slicing dialog is disabled if no append function is available.

! 2006-09-22 - Nicolas Gilardi
 - Due to a misunderstanding of how payload storage worked, a major change in
   the behavior of conddbui.storeXMLString was necessary. the "data" parameter
   is now supposed to be a dictionary structured like the attribute list that
   will be stored in the folder, i.e. with the same list of keys.
 - The list of tags in the browser's data display is now correctly refreshed
   when selecting a channel.
 - The list of folders of the slicing dialog is properly cleaned when exiting
   the dialog.
 - copy_files_to_db.py can now handle multiple payload keys. They are extracted
   from XML filenames of the form keyname@foldername.xml.

! 2006-09-19 - Nicolas Gilardi
 - modified the interface to database slicing in the browser. It is now
   possible to select more than one tag at a time for a given selection object.

! 2006-09-13 - Nicolas Gilardi
 - Created two new functions for conddbui.Tag objects: Tag.getAncestorTagsDict
   and Tag.getAncestorTags. They work pretty much the same as
   Tag.getAncestorsBranches and Tag.getAncestors, except that they return tag
   objects instead of strings.
 - Modified the display of tag names in the tag selection list of the browser.
   The name of the node where the tag is defined is also given between brackets.
 - Added a check box which filters out the _auto_ tags.

! 2006-09-12 - Nicolas Gilardi
 - Created a new dialog class guidialogs.slicingDialog. It is called by the
   browser via the menu Database/Slice. It allows to copy data from the active
   database to a target database (SQLite) which may exist or not. This is a
   limited version of the PyCoolCopy.append function. It works, but need more
   tests.
   WARNING: as the PyCoolCopy.append function isn't available in COOL_1_3_2, a
   copy of the latest version is provided in CondDBUI/v0r4/src.
 - added the importation of append from PyCoolCopy in conddbui.py.
 - cleaned up guidialogs.py from obsolete dialogs.

! 2006-09-08 - Nicolas Gilardi
 - Fixed a bug in guiextras.myDBTable
 - removed obsolete guibridge.py and recursive_tag.py files from cvs

! 2006-09-04 - Nicolas Gilardi
 - Fixed a bug preventing to display single version conditions in the browser

! 2006-08-31 - Marco Clemencic
 - Fixed a bug in the copy_files_to_db.py script that was preventing to add
   data to an existing database.

! 2006-08-22 - Marco Clemencic
 - Added the script to create a DB from files

! 2006-08-16 - Nicolas Gilardi
 - Completely changed the Add Condition dialog to take into account multiple
   storage keys. Now, you have to set the object information (IoV, channelID),
   and select the payload to edit in the list of keys, on the right. Pressing
   the "Edit" button will open an internal editor with one tab per selected
   key. You can edit the text from there (xml header is provided by default,
   but not verified). It is possible to load text from file, or to export the
   current text to a file. 3 buttons are also provided to help writing the main
   tags used in the xml data.
   When payload edition is done, user can "add" the condition object to the
   stack, at the bottom of the Add Condition dialog.
 - Modified the Create Node dialog in the browser. User have to provide some
   storage keys for the attribute list specification. Default is simply 'data'.
 - Modified conddbui.CondDB.createNode(). When creating a folder, a list of
   storage keys must be provided. Its default value is ['data'].
 - Created conddbui.CondDB.getFolderStorageKeys(). It returns the list of keys
   used by the Coral Attribute List to store the payload in the given folder.
 - Modified conddbui.CondDB.storeXMLStringList. The XMLList parameter is now a
   list of dictionaries, with keys 'path' (folder path), 'channel' (channel ID),
   'payload' (a dictionary similar to the attribute list which will be stored
   in the database), 'since' and 'until' (the bounds of the IoV).
 - Modified conddbui.CondDB.storeXMLString. It is now possible to give a
   Coral Attribute List key (which is "data" by default).

! 2006-08-04 - Nicolas Gilardi
 - Created the guiextras.CondDBTree class which includes the database tree and
   the location bar of the browser.
 - Moved guiwin.myWindow.createLeaves and guiwin.myWindow.resolvePath to
   guiextras.CondDBTree.
 - Put back the possibility to open an SQLite database not defined in the
   dblookup.xml file:
   * go to menu DataBase/Open
   * in the DBLookUp Alias combo box, chose "SQLite file" (last entry)
   * this opens a file selection dialog. Chose the sqlite file you want
   * back to the open database dialog, give the Database Name
   * press Open DB when done.

! 2006-08-03 - Nicolas Gilardi
 - Created CondDB.getAttributeList and CondDB.getAttributeListList (ok, not a
   nice name, but it is the best I have so far). They behave like
   CondDB.getXMLString and CondDB.getXMLStringList, but get the full contents
   of the Coral Attribute List in a dictionary instead of a single XML string.
 - Simplified CondDB.getXMLString and CondDB.getXMLStringList to reduce code
   duplication with the above new functions.
 - Updated guitree.guiChannel.setCondDBCache to store dictionaries of XML data
   instead of a single XML string.
 - Updated guiextras.MyDBTable._fillTable and guiextras.MyDBTable.showData to
   fit with the new behaviour of the guiChannel's CondDBCache.

! 2006-08-03 - Nicolas Gilardi
 - Major modifications of the guiextras.myDBTable class:
    * It is now a horizontal QSplitter.
    * The text viewer is always visible on the left.
    * The panel on the right contains: the IOV/Tag filter, the IOV table and
      the payload selector.
    * Payload selector is a new element which will contain the keys of the
      Coral Attribute List stored in the database. For the moment, it contains
      only one entry named "data", but in the future, it may contain many
      different elements.
    * The text displayed depend on both the active line of the IOV table and
      the selected element of the payload selector.
    * It is possible to save the content of the text viewer to a file by
      pressing the button "Export to File".
 - Backward compatible modifications of CondDBUI.getXmlString and
   CondDBUI.getXmlStringList to which it is now possible to give a Coral
   Attribute List key (which is "data" by default).

! 2006-07-28 - Nicolas Gilardi
 - Created a special environment variable $CONDDBUI_SESSIONS_PATH where the
   sessions.dbm file is expected to be.
 - Added support for "read only" and "read/write" access to COOL databases. Two
   functions modified: conddbui.CondDB.__init__ and conddbui.CondDB.openDatabase.
   Both now take an optional argument "readOnly" with default value to "True".
 - Major changes in the open database behavior of the Browser:
    * Existing databases _must_ be defined in $CORAL_DBLOOKUP_PATH/dblookup.xml.
      The browser provides a list of database aliases taken from this file.
    * Sessions are no longer user defined: the last 5 sessions are stored in
      sessions.dbm and accessible via the menu DataBase/Recent.
 - Modified the browser's exception catcher to display which function catched
   the exception.
 - Updated CondDBUI module documentation

! 2006-07-19 - Nicolas Gilardi
 - Fixed a bug in the browser which prevented to display the payload if an
   ancestor tag was selected.

!=========== Tools/CondDBUI v0r4 2006-09-29 ===================================
! 2006-06-20 - Nicolas Gilardi
 - Added attribute "connectionString" to the CondDB class
 - Fixed the compatibility issue of CondDBUI with Windows path
 - Modified the browser to include tagging and database creation and dropping
 - Fixed some bugs in the browser when adding conditions
 - Updated Browser's documentation
 - Created epydoc documentation for CondDBUI
 - Cleaned the doc directory

! 2006-06-16 - Marco Clemencic
 - made CondDB.dropDatabase a class function
 - modified the test function to use a temporary file for the SQLite db
 - fixed few comments
 - added a work-around for the problem of PyCool intercepting the command line
   argments

! 2006-06-09 - Nicolas Gilardi
 **** requires LCGCMT 43b  ****
 - renamed python/conddbui.py to python/browser.py
 - added src/conddbui.py: user API to LHCb COOL
 - documentation isn't up to date


