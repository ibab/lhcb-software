!-----------------------------------------------------------------------------
! Package     : Det/RichDet
! Responsible : Antonis Papanestis
! Purpose     : Interface to the xml description
!-----------------------------------------------------------------------------

!========================= RichDet v17r4 2015-07-20 =========================
! 2015-06-02 - Marco Cattaneo
 - Fix xml selection rule for dict, to please genreflex

!========================= RichDet v17r3 2015-05-26 =========================
! 2015-05-05 - Chris Jones
 - Make the HLT refractive indices the default ones.

!========================= RichDet v17r2 2015-02-23 =========================
! 2015-02-16 - Chris Jones
 - Use long int instead of just int in DeRichHPDPanel::findHPDColAndPos to 
   avoid FPE's when truncating very large doubles to integer values.

! 2015-02-06 - Chris Jones
 - Various speed improvements to DeRichHPDPanel (such as removing completely
   an unneccessary virtual function call and dynamic_cast, when getting the
   DeRichHPD object for a given HPD number...).

!========================= RichDet v17r1 2015-01-14 =========================
! 2015-01-12 - Antonis Papanestis
 - Found a bug related to the new InactiveHPDList condition (not yet
   active) that prevented the reading of the new inactive HPD list from
   the ONLINE partition.

!========================= RichDet v17r0 2014-12-11 =========================
! 2014-11-22 - Antonis Papanestis
 - Protected debug output with 
     if ( msgLevel(MSG::DEBUG) )

! 2014-11-19 - Antonis Papanestis
 - Changes to DeRichSystem in order to move the DetectorNumbers 
   condition from CondDB to ONLINE. The conditions has been split with the
   inactive HPDs in a new condition. The changes work with any version of 
   DDDB, however, a new DDDB version would need the correct ONLINE
 - Added method systemVersion() (there is already a version() in detector
   elements that is always empty)

!========================= RichDet v16r25 2014-10-14 =========================
! 2014-10-01 - Chris Jones
 - Update RichSmartID search in DeRichSystem to avoid type mis-matches
   caused by updates to RichSmartID.

!========================= RichDet v16r24 2014-07-14 =========================
! 2014-06-17 - Chris Jones
 - Added support to DeRichHPD for MDMS version 1. Implements a per-HPD scaling
   pf the MDMS parameters based on the the per-run HPD image size.
 - Use the VDT math library in a few more places.

!========================= RichDet v16r23 2014-06-10 =========================
! 2014-05-21 - Sajan Easo
 - Added couple of tests of Status code

!========================= RichDet v16r22 2014-05-12 =========================
! 2014-05-08 - Sajan Easo
 - Added a test on StatusCode::FAILURE and removed a print statement in DeRichPMTPanel.cpp  

!========================= RichDet v16r21 2014-03-17 =========================
! 2014-02-23 - Chris Jones
 - Fix some tests added in previous test to demand gas properties vectors are
   larger or equal to the number of gases in a given micture, rather than
   exactly equal.

! 2014-02-21 - Chris Jones
 - Put an FPE::Guard into DeRichGasRadiator::calcSellmeirRefIndex to protect
   against a very very weird FPE exception when running clang...

!========================= RichDet v16r20 2014-02-17 =========================

! 2014-02-07 - Sajan Easo
 - Fixed minor issue with RICH2 Local PD plane transform definiton for PMts 
   for plotting the hit coordinates in in the PD plane. 
   Fix is done in DeRichPMTPanel. 

! 2013-12-19 - Sajan Easo
 - Fixed a compilation warning in DeRichHPDPanel.h 

! 2013-12-18 - Sajan Easo
 - Adaptation for using large+standard PMTS in RICH2. Modified DeRich, DeRichPMT, 
   DeRichPMTPanel.

!========================= RichDet v16r19 2013-09-30 =========================
! 2013-09-27 - Chris Jones
 - Miscelleanous clean up of the last commit.

! 2013-09-27 - Sajan Easo
 - Adaptation for using large PMTS in RICH2. Modified DeRich, DeRichPMT, 
   DeRichPMTPanel.
 - Fix some compilation warnings.

! 2013-07-19 - Sajan Easo
 - Minor fix in DeRichPMTPanel.cpp to avoid compilation warnings in some platforms

!========================= RichDet v16r18 2013-07-17 =========================
! 2013-07-17 - Chris Jones
 - Updated use of the VDT library, to use vdt::fast_sincos to compute both
   in one call.

! 2013-07-16 - Chris Jones
 - Replace use of private Rich::Maths::atan2 function with alternative from 
   the VDT library, which are more accurate.
 - Use VDT for a couple cos and sin calculations in 
   DeRichHPD::magnifyToGlobalMagnetON.

!========================= RichDet v16r17 2013-04-29 =========================
! 2013-04-29 - Marco Cattaneo
 - Replace endreq by endmsg

! 2013-04-09 - Chris Jones
 - Various small CPU optimisations. Replace std::atan2 with faster, but 
   slightly less accurate Rich::Maths::atan2_f in DeRichHPD.

! 2013-03-25 - Antonis Papanestis
 - Fix a bug introduced in DeRichPMTPanel

! 2013-03-23 - Antonis Papanestis
 - Un-did some of the changes needed for the single RICH because the broke 
   the current geometry. This version will not work with the single RICH

! 2013-03-22 - Antonis Papanestis
 - Changes in DeRichSystem for the single RICH simulation. Allow one Rich 
   detector with number 0 or 1

!========================= RichDet v16r16 2013-03-20 =========================
! 2013-03-10 - Sajan Easo
- Fix for DePMTPanel to avoid pmt pixel row/column to exceed the allowed range (0-7).
- Fix to avoid potential memory leak for array related to pmt lens.  

!========================= RichDet v16r15 2013-02-05 =========================
! 2013-02-05 Sajan Easo
 - Modifications for PMTS with Lenses : safety check for no-lens PMT data

! 2013-01-28 - Sajan Easo
 -  Modifications for PMTS with Lenses in DePmt and DePmtPanel

!========================= RichDet v16r14 2012-11-26 =========================
! 2012-11-20 - Antonis Papanestis
 - Check the list of inactive Photo-Detectors for possible errors in 
   DeRichSystem

! 2012-11-15 - Marco Clemencic
 - Added CMake configuration file.

! 2012-10-31 - Antonis Papanestis
 - Added method rich() to DeRich to return the DetectorType
 - Added missing converters for DeHorizRich
 - Added DeHorizRich in the dictionary files.


! 2012-10-24 - Antonis Papanestis
 - Addition of new clas DeHorizRich
 - Modifications in DeRichSphMirror DeRichPMTPanel DeRichPMT &
   DeRichBase to be able to run with a single Rich detector
 - The idea is that the available RICH detectors can be found as a user
   parameter of detector element AfterMagnetRegion
 - The location DeRichSystem can be found as a parameter in the first
   RICH detector in the list of AfterMagnetRegion

! 2012-10-18 - Marco Cattaneo
 - Fix an unprotected verbose message
 - Fix an UNINIT_CTOR

! 2012-10-15 - Antonis Papanestis
 - Bug fix in previous commit of DeRichRadiator

! 2012-10-12 - Antonis Papanestis
 - Updated DeRichRadiator to set correctly the rich() and radiatorID() for
   the upgrade to a signle Rich detector

!========================= RichDet v16r13 2012-09-28 =========================
! 2012-09-21 - Marco Clemencic
 - Fixed compilation with -std=c++11 (-std=c++0x).

!========================= RichDet v16r12 2012-07-24 =========================
! 2012-07-15 - Chris Jones
 - Add methods to DeRichSystem to return the number of PDs for each RICH

! 2012-06-26 - Chris Jones
 - Fix a small bug in DeRichPMTPanel, where a null pointer was not properly
   protected against being dereferenced.

!========================= RichDet v16r11 2012-06-15 =========================

! 2012-06-10 - Chris Jones
 - Fix DeRichGasRadiator to allow the scale factors to be used Online.

!========================= RichDet v16r10 2012-05-02 =========================
! 2012-04-21 - Chris Jones
 - Add methods to DeRichMultiSolidRadiator to allow explicit access to the
   Aerogel full and sub tiles. Useful for the Aerogel calibration.

! 2012-04-11 - Chris Jones
 - Fix a bug where when running in the HLT, the Rich::TabulatedProperty1D
   object for the HLT refractive index interpolator was not deleted.

!========================= RichDet v16r9 2012-01-31 =========================
! 2012-01-06 - Chris Jones
 - Add some additional debug and verbose printouts to DeRichSystem

! 2012-01-05 - Chris Jones
 - Fix a bug where a few maps where not cleared in
   DeRichSystem::buildPDMappings() before being (re)filled.

!========================= RichDet v16r8 2011-12-14 =========================
! 2011-11-25 - Chris Jones
 - Remove MaPMT specific hacks from DeRichSystem. No longer needed as DB is
   now correct.

! 2011-11-24 - Chris Jones
 - Add a method to the PD Panel base class to return PD type

! 2011-11-24 -Sajan Easo
 - Made a fix to DeRichPMTPanel for rich2 plane definition.

! 2011-11-23 - Sajan Easo
 - Made a fix to the pmt smartid decoding to hits in DeRichPMT and added more
   utilities to DeRichPMTPanel

! 2011-11-17 - Chris Jones
 - Add PMT classes from Sajan

!========================= RichDet v16r7 2011-11-07 =========================
! 2011-10-05 - Chris Jones
 - Preliminary changes for future MaPMT support
  + add new DeRichPD and DeRichPDPanel classes that the HPD specific DeRichHPD
    and DeRichHPDPanel classes now inherit from. provide the generic methods
    needed by any PD type (HPD or MaPMT). Used in the recosntruction, so it
    becomes neutral to the PD technology.

!========================= RichDet v16r6 2011-08-30 =========================
! 2011-08-22 - Chris Jones
 - Add DeRichRadiator::Vector to python dictionary
 - Add a new method to DeRichSystem to return the L1 logicla ID for a given
   HPD RichSmartID

!========================= RichDet v16r5 2011-07-25 =========================
! 2011-07-21 - Chris Jones
 - Add the UNLIKELY macro to the msgLevel methods in DeRichBase
 - Add a little extra protection to casts in DeRichBeamPipe to
   appease coverity

! 2011-07-14 - Chris Jones
 - Add new method DeRichAerogelRadiator::subTile() that indicates if the
   detector element is subtile (true) or full primary tile (false)

! 2011-07-07 - Chris Jones
 - Update the tile ID methods in DeRichAerogelRadiator to support better the
   needs of Brunel, by making tileID() give a unique ID both when sub-tiles
   are active and inactive. Add a new method primaryTileID() that returns the
   primary (real) tile ID.

! 2011-07-05 - Chris Jones
 - Add new methods to DeRichBase to allow the output level to be checked, and
   thus debug and verbose printed to be suppressed when not activate.

! 2011-06-10 - Sajan Easo
 - For using the new version of database with aerogel sub tiles,
   modifications made to DeRichAerogelRadiator
   and DeRichMultiSolidRadiator. These are backward compatible and hence can
   be used for old version of database without the aerogel sub tiles.

!========================= RichDet v16r4 2011-06-14 =========================
! 2011-05-25 - Chris Jones
 - Add some missing protection for failed dynamic casts in DeRichHPDPanel and
   DeRichSphMirror
 - Some other minor code tidy ups

!========================= RichDet v16r3 2011-04-26 =========================
! 2011-04-14 - Chris Jones
 - Remove some obsolete DC06 compatibility hacks
 - Return StatusCode FAILURE from DeRichSystem::initialize() if initial
   update fails.

! 2011-04-07 - Chris Jones
 - Improve the way various cached information is handled w.r.t. condition
   updates.

! 2011-04-05 - Chris Jones
 - Move all of the initialisation of variables in DeRichSphMirror::initialize()
   to DeRichSphMirror::updateGeometry(), in order to make sure everything
   is properly updated on Condition changes.

!========================= RichDet v16r2 2011-04-04 =========================
! 2011-03-31 - Antonis Papanestis
 - Chages in DeRichGasRadiator to allow easy change of gas in RICH1
   Gas mixture is supported only if CO2 parameterisation is used for
   C4F10 as well (currently not the case).

! 2011-03-28 - Chris Jones
 - Add missing clear() on L0 to L1 Hardware ID map during
   DeRichSystem::buildHPDMappings()

! 2011-03-23 - Chris Jones
 - Add new method to DeRichSystem to return the Level1 Hardware ID for a
   given Level0 ID
 - Add some checks when filling all the various maps, to
   first see if an entry already exists. If it does a warning is printed and
   an error returned.

! 2011-03-04 - Chris Jones
 - Add missing !HltMode to use of condition("RadiatorComposition") and some
   basic protection against null pointer dereferencing

! 2011-02-27 - Chris Jones
 - Adapt to changes in RichSmartID class.

!========================= RichDet v16r1 2011-02-22 =========================
! 2011-02-21 - Chris Jones
 - A few more miscellaneous tidy ups

! 2011-02-17 - Chris Jones
 - Fix various coverity UNINT_CTOR defects

! 2011-02-17 - Antonis Papanestis
 - Removed unused variable from DeRichHPDPanel

! 2011-02-16 - Chris Jones
 - Rework the way the various DeRich objects initialise, moving as much as
   possible to happen on demand, instead of always being done by default.
 - Fix various icc warnings/remarks, without resorting to #pragma

! 2011-02-02 - Chris Jones
 - Adapt to removal of depreciated RichRadIntersection typedef.
 - Remove some obsolete CVS doxygen comments

!========================= RichDet v16r0 2011-01-31 =========================

! 2011-01-31 - Rob Lambert
 - The following change was accidentally not added into v15r3,
   although the release notes were changed.

! 2011-01-31 - Antonis Papanestis
 - Changed the way to handle the refractive index of a gas radiator. Now the
   relevant parameters can be read from the CondDB and a gas mixture is
   supported.

!========================= RichDet v15r3 2011-01-31 =========================
! 2011-01-12 - Marco Cattaneo
 - Fix ICC warnings and remarks

! 2010-12-28 - Antonis Papanestis
 - Modified DeRichSystem to accept the list of inactive HPDs as a list of
   human readable smartIDs. Fully backwards compatible (new parameter
   in the condition)

! 2010-12-15 - Chris Jones
 - Add new methods to DeRichSystem to provide lists of all HPDs, either active
   or inactive, in both RichSmartID and HardwareID formats.

!========================= RichDet v15r2 2010-11-27 =========================
! 2010-11-12 - Chris Jones
 - Add new methods to DeRichSystem to :-
  + Provide access to the vector of inactive HPDRichSmartIDs
  + Prove a new method to get the L1 Copy Number from a hardware ID

!========================= RichDet v15r1 2010-10-25 =========================

! 2010-10-16 - Chris Jones
 - Add a couple utility methods to the DeRichLocations namespace that return
   the DDDB location of the detector element for a given radiator or detector
   type enum.
 - Remove CVS doxygen comments

!======================== RichDet v15r0 2010-08-25 ===========================

! 2010-08-19 - Sajan Easo
 - Refractive index of CF4 corrected by using the correct reference
   temperature. This fine tunes the refractive index by shifting n-1 by about
   7 percent. This can be used with older versions of DDDB.
   The adhoc corrections made in conddb so far
   for real data can be removed when using this by setting the
   RefractivityScaleFactor" to 1.0 in ../Conditions/Rich2/Environment/Gas.xml
   For MC data this was always 1.0 anyway. All changes in DeRichGasRadiator.cpp
- Improved Refractive index of RICH2 gas by using a new parametrization
  from a recent reference.
   This needs the new DDDB modifications as of Aug20-2010.
   In case of using the old DDDB the above
   mentioned correction will be automatically used to give the same correct
   refractive index. All changes in DeRichGasRadiator.cpp

! 2010-08-08 - Chris Jones
 - Suppress info messages from DeRichSystem on number of L1 boards etc.

!======================== RichDet v14r5 2010-07-19 ===========================
! 2010-06-24 - Chris Jones
 - Various improvements to Rich::TabulatedFunction1D
  + Fix the rms() method to return a real RMS (was returning the standard
    deviation)
  + Add an explicit standardDeviation() method
  + Add to the rms() and new standardDeviation() and optional weight function
    that can be used during the calculations if supplied to weight (multiply)
    the function.
  + Add a new static method combine() that takes a vector of tabulated
    functions, merges them, and returns a new function that represents the
    product of the functions.
  + Inline the constructors for speed

!======================== RichDet v14r4 2010-06-18 ===========================
! 2010-06-18 - Chris Jones
 - Add a public method to DeRichMultiSolidRadiator to allow access to the list
   of single solid radiators making up the multisolid radiator.

! 2010-06-17 - Chris Jones
 - Add a public method to DeRichAerogelRadiator to allow access to the tile ID
   number.

!======================== RichDet v14r3 2010-05-21 ===========================
! 2010-05-17 - Antonis Papanestis
 - Update to allow the detector element to initialize even if the
   normal gas conditions are not there. The HLT gas conditions are required
   in this case. If the normal refarctive index is asked for in the HLT
   environment an exception is thrown.

!======================== RichDet v14r2 2010-04-26 ===========================
! 2010-04-23 - Antonis Papanestis
 - Added protection for a zero second order demagnification factor. The
   solution becomes linear with inverse 1st order factor

! 2010-04-23 - Antonis Papanestis
 - Fixed a bug (m_MDMS_version was a bool instead of an int)

! 2010-04-23 - Chris Jones
 - Include (n-1) scale factor in printout on gas refractive index updates.

! 2010-04-22 - Antonis Papanestis
 - Changes for a new HPD magnification algorithm in the presence of magnetic
   field.

! 2010-04-22 - Stephanie Hansmann-Menzemer
 - addapt to changes in magnetic field service

!======================== RichDet v14r1 2010-04-09 ===========================
! 2010-03-25 - Sajan Easo
 - Added the capability to use the C3F8 as RICH1 Gas in DeRichGasRadiator.cpp.
   This modification is backward compatible.

! 2010-03-23 - Chris Jones
 - Minor speed improvements to DeRichHPD when updating for T/P condition changes.

!======================== RichDet v14r0 2010-03-17 ===========================
! 2010-03-09 - Antonis Papanestis
 - Allow the use of different demagnification parameters for positive and
   negative magnetic field

!======================== RichDet v13r4 2010-02-12 ===========================
! 2010-02-03 - Antonis Papanestis
 - Change output level to DEBUG for the update of parameters in the HPDs

! 2010-01-21 - Antonis Papanestis
 - Correctly handle the presence or absence of magnetic field for the
   magnetic field corrections in the HPDs.
 - It's possible to force the use of magnetic corrections using a DDDB parameter

!======================== RichDet v13r3 2010-01-20 ===========================
! 2010-01-14 - Antonis Papanestis
 - Fixed printout error for pressure in GasRadiator
 - Forced the use of magnetic distortion code in HPD
 - Added new function for going from anode to cathode in DeRichHPD

! 2010-01-12 - Antonis Papanestis
 - Missing class DeRichBase from the dictionary.

!======================== RichDet v13r2 2009-12-11 ===========================
! 2009-12-10 - Antonis Papanestis
 - new (single) condition for the temperature and pressure of the
   Gas Radiators

!======================== RichDet v13r1 2009-11-22 ===========================
! 2009-11-19 - Antonis Papanestis
 - Protection against DDDB/LHCBCOND mismatch with missing conditions

!======================== RichDet v13r0 2009-11-13 ===========================
! 2009-11-11 - Antonis Papanestis
 - Introduce separate refractive index for the HLT.

!======================== RichDet v12r1p1 2009-09-02 =========================
! 2009-09-02 - Marco Cattaneo
 - Remove obsolete file RichDet_dll.cpp

! 2009-08-03 - Chris Jones
 - Convert all endreq to endmsg

!======================== RichDet v12r1 2009-07-28 ===========================
! 2009-07-26 - Chris Jones
 - Add new base class 'DeRichBase' that implements various common
   functionality for all RICH detector elements.

! 2009-07-17 - Antonis Papanestis
 - Small change in DeRichSphMirror to pick up the Surface location
   from a user parameter (rather than trying to guess it).

!======================== RichDet v12r0 2009-06-29 ===========================
! 2009-06-26 - Antonis Papanestis
 - New transform from the global frame to the photodetector panel frame that
   can cope better with misalignments. Method globalPosition removed from
   DeRichHPDPanel.

!======================== RichDet v11r5p1 2009-06-16 =========================
! 2009-06-11 - Chris Jones
 - Fix WIN32 warnings

!======================== RichDet v11r5 2009-05-06 ===========================
! 2009-05-01 - Antonis Papanestis
 - Introduce condition to scale refractivity (n-1) of the gas radiators

! 2009-04-30 - Chris Jones
 - Sort inactive HPD lists

! 2009-03-30 - Chris Jones
 - Include P and T values in message printed when a refractive index
   update occurs.

!======================== RichDet v11r4 2009-01-08 ===========================
! 2008-11-30 - Chris Jones
 - Add new virtual method to DeRichRadiator base class to return the
   refractive index for a given photon energy. Implemented in both the single
   and multi gas radiator derived classes. In the multi solid case an average
   of all associated single solid radiators is taken. This method is needed
   to allow the reconstruction to treat all radiator volumes in a generic
   manor regardless of their composition.

!======================== RichDet v11r3 2008-11-17 ===========================
! 2008-10-28 - Marco Cattaneo
 - Fixes for gcc 4.3 compilation

! 2008-10-22 - Marco Cattaneo
 - Remove extra qualifier in Rich1DTabFunc.h, to please latest genreflex

!======================== RichDet v11r2 2008-09-30 ===========================
! 2008-09-30 - Marco Cattaneo
 - Protect use of condition() method following changes to DetDesc

! 2008-09-27 - Christopher Rob JONES
 - Add method (request from monitoring) to access the HPD hardware ID
   associated to a given L1 Hardware ID + L1 input number

! 2008-09-25 - Antonis Papanestis
 - Bug fix to stop DeRichHPD from throwing an exception when testing
   if a condition (QE location) exists.

!======================== RichDet v11r1 2008-09-02 ===========================
! 2008-08-18 - Chris Jones
 - Add method to DeRichRadiator to provide interpolated function for the
   effective absorption length, as a function of photon energy.
 - Make sure interpolators in DeRichRadiator are re-initialised when the
   underlying tables are updated.
 - Move the method initTabPropInterpolators() to the DeRichRadiator base class.
 - Add the public method initInterpolator to Rich::TabulatedProperty1D to
   allow the forced re-initialisation of the interpolator.

!======================== RichDet v11r0 2008-07-27 ===========================
! 2008-07-25 - Chris Jones
 - Add to DeRichSystem mapping between L1 hardware and logical IDs

! 2008-07-24 - Antonis Papanestis
 - Added HPDCopyNumber to DeRichSystem
 - Required changes for R2 mirrors now using framework alignment conditions
   ( DeRich2, DeRichSphMirror)

! 2008-06-06 - Antonis Papanestis
 In DeRichHPDPanel:
 - Added method to retrieve the local z offset of the detection plane.
 - Removed method globalToPDPanel.
 - fixed problem with local x/y offset.

! 2008-05-07 - Chris Jones
 - Remove obsolete object locations in DeRichLocations.h

!======================== RichDet v10r11 2008-04-15 ==========================
! 2008-04-10 - "Antonis Papanestis"
 - Changes in DeRichHPD and Panel to cope with the new multiple HPD logical
   volumes.

! 2008-02-17 - Chris Jones
 - Remove use of floor function in DeRichHPDPanel::findHPDColAndPos
   (surprisingly slow)

!======================== RichDet v10r10 2008-02-15 ==========================
! 2008-02-15 - Chris Jones
 - Add a new public method to DeRichHPDPanel to return a pointer to the
   DeRichHPD object associated to a given HPD as defined by a RichSmartID

!======================== RichDet v10r9 2008-02-02 ========================
! 2008-01-29 - "Antonis Papanestis"
 - Changes for composite (CMA) Rich1 spherical mirrors. The Rich1 mirrors
   now have individual alignment conditions.
 - Introduced user parameters in DeRich1/2 for the location of the
   mirror reflectivity.

! 2008-01-10 - "Antonis Papanestis"
 - Changes for post-DC06 xml description.
 - New locations for detector elements. The paths are parameters
   in DeRich1 and DeRich2, which can stiil be found in DeRichLocations.
 - Individual QE per HPD (Rich::TabulatedProperty1D) from LHCBCOND (Tabulated
   Property). Warning from 4 HPDs (one per panel) if not found.
 - Changes compatible with DC06.
 - One method for magnification in DeRichHPD, for both old and new way.

! 2008-01-09 - Chris Jones
 - Changes to how the DeRichHPD and DeRichHPDPanel objects deal with the
   method DeRichHPDPanel::PDWindowPoint which calculates the intersection
   with the HPDs
  + Various fixes to correct a small disagreement between ray tracing results
    and the full photon reconstruction.
  + Clean up a little how the various transforms from DeRichHPD are accessed
  + Add the method DeRichHPD::testKaptonShadowing which checks for
    intersections with the kapton shield
  + Various other minor doxygen and code improvements

!======================== RichDet v10r8 2007-12-04 ========================
! 2007-12-04 - Chris Jones
 - Update Rich::TabulatedFunction1D to allow an existing object to be
   re-initialised with new data values.
 - Update DeRichHPD to use new re-initialisation functionality of
   Rich::TabulatedFunction1D

! 2007-11-09 - "Antonis Papanestis"
 - Cleaned up DeRichHPD and DeRichHPDPanel and made them fully compatible
   with the alignment framework.
   Method detectionPoint now has an option to chose between the
   photoCathode side, or the outside of the window (including refraction
   correction).

!======================== RichDet v10r7 2007-09-17 ========================
! 2007-09-13 - Juan PALACIOS
 - Changes to adapt to new IGeometryInfo interface.
   NEEDS Det/DetDesc v18r0 OR HIGHER!
 - Files modified:
   RichDet/DeRichBeamPipe.h
   RichDet/DeRichHPD.h
   src/Lib/DeRichBeamPipe.cpp
   src/Lib/DeRichHPD.cpp
   src/Lib/DeRichHPDPanel.cpp
   src/Lib/DeRichMultiSolidRadiator.cpp
   src/Lib/DeRichSingleSolidRadiator.cpp
   src/Lib/DeRichSphMirror.cpp

! 2007-09-13 - Juan PALACIOS
 - cmt/requirements
   . Increase version to v10r7

! 2007-08-13 - Chris Jones
 - Update DeRichHPDPanel TDS locations
 - Update methods that return a RichSmartID to always set the HPD properties
   for the closest HPD, even if the hit is outside the HPD tube acceptance
   and for the method that only traces to the HPD plane.

! 2007-08-09 - Chris Jones
 - Update DeRichHPD to cache the transformation matrix for the silicon
   sensor to speed up the detectionPoint method
 - Update methods that find the points on the detection plane to return
   a summary object indicating the acceptance

!======================== RichDet v10r6 2007-07-09 ========================
! 2007-06-06 - "Antonis Papanestis"
 - small change to take into account the misalignmet of the Si sensor
   in the conversion from smartID to detection point

!======================== RichDet v10r5 2007-05-25 ========================
! 2007-05-25 - Marco Cattaneo
 - Add DeRichLocations::* to dictionary
 - Fix doxygen warnings

!======================== RichDet v10r4 2007-04-23 ========================
! 2007-04-23 - Marco Cattaneo
 - Make LCG dictionaries for public classes (previously in DetSys)

! 2007-04-23 - Chris Jones
 - Move RichDAQDefinitions.h into RichKernel -> Introduce dependency on
	 RichKernel

! 2007-04-04 - Chris Jones
 - Improve doxygen comments in DeRichSystem
 - Some more optimisation in DeRichSystem, by making some methods inline

! 2007-04-02 - "Antonis Papanestis"
 - move the detectionPoint functionality from DeRichHPDPanel to DeRichHPD
   to be able to use individual properties of HPDs.
 - Added DeRichLocations.h to hold all the locations of DeRich objects
 - Added methods in DeRichSystem to return the copy number and xml
   location of an HPD in smartID form.

! 2007-03-26 - Chris Jones
 - Some speed improvements for HLT
  + Remove MsgStream object
  + Make some methods non virtual (not needed to be virtual)
  + Use new flag in RichTraceMode to control checking for intersections
    with kapton HPD shields
  + Various small tidy ups
 - Additions to DAQ definitions

!======================== RichDet v10r3 2007-03-20 ========================
! 2007-03-19 - Chris Jones
 - Replace use of Gaudi format with boost::format to fix various issues

! 2007-03-09 - Chris Jones
 - Add some new DAQ definitions

! 2007-03-02 - Chris Jones
 - Improve doxygen comments in DeRichSystem and for namespaces

!======================== RichDet v10r2 2007-03-01 ========================
! 2007-03-01 - Marco Cattaneo
 - Remove obsolete RichDet_load.cpp

! 2007-02-28 - Marco Clemencic
 - Replaced "const CLID&" with "const CLID"

!======================== RichDet v10r1 2007-02-06 ========================
! 2007-02-06 - Marco Cattaneo
 - Remove LHCbDefinitions includes

! 2007-02-01 - Chris Jones
 - Updates to RichDAQDefinitions for new L1 data format
 - Various comment improvements
 - Removal of old "XXX_old" location names
 - Adapt to new Rich::DAQ namespace
 - Move MirrorSegPosition, 1TabFunc and 1DTabProperty into Rich namespace

!======================== RichDet v10r0 2006-12-14 ========================
! 2006-12-06 - Florence RANJARD
 - apply_pattern install_more_includes

! 2006-12-02 - Chris Jones
 - Add method to DeRichBeamPipe to only test for intersection.
   Skips computing the entry and exit points in global coords,
   so is a bit faster.

!======================== RichDet v9r9 2006-12-01 =========================
! 2006-12-01 - Marco Cattaneo
 - Use DECLARE_CONVERTER_FACTORY macros

! 2006-11-29 - Antonis Papanestis
 - Add DeRichBeamPipe class, requires update in the XmlDDDB
 - Minor bug fixes

! 2006-11-23 - Chris Jones
 - Remove the use of "using namespace LHCb" in DeRichSystem.h

!======================== RichDet v9r8 2006-11-03 =========================
! 2006-11-03 - Marco Cattaneo
 - Remove second format() call from DeRichSystem.cpp
 - Always take SystemOfUnits.h from GaudiKernel

! 2006-11-01 - Chris Jones
 - Updates to RichDet to implement refraction correction at HPD (Antonis)
   Improves CK theta resolution a little. Requires XmlDDDB v30r13 or greater

!======================== RichDet v9r7 2006-10-20 =========================
! 2006-11-03 - Marco Cattaneo
 - Add missing converter factory to RichDet_load.cpp

! 2006-10-20 - Chris Jones
 - Updates for new RichRadIntersection class (now in LHCbKernel)

! 2006-10-18 - Antonis Papanestis
 - Add DeRichHPD class to handle conditions and misalignments.
 - Add the modifications from Marco Musy for the magnetic field distortions.
   Requires new version of XmlDDDB and XmlConditions.

! 2006-09-07 - Chris Jones
 - Add new L1 data versions

!======================== RichDet v9r6 2006-08-31 =========================
! 2006-08-31 - Marco Cattaneo
 - Get Gaudi::Units includes from GaudiKernel

! 2006-08-28 - Chris Jones
 - Introduce new constructor for Rich1DTabFunc

! 2006-08-09 - Chris Jones
 - Adapt to improvements in ray tracing mode object RichTraceMode

! 2006-08-02 - Antonis Papanestis
 - Fixed a bug in ray tracing
 - Added a function to convert the HPD number (start at 0 in every panel) to
   the HPD copy number (unique in the Rich system, same as in G4)

!========================= RichDet v9r5 2006-06-15 =========================
! 2006-06-07 - Antonis Papanestis
 - Fixed bug in HPD demagnification

! 2006-06-02 - Antonis Papanestis
 - Added method detPointOnAnode in DeRichHPDPanel
 - Minor change in DeRichGasRadiator

!========================= RichDet v9r4 2006-05-17 =========================
! 2006-05-17 - Marco Cattaneo
 - Adapt to Gaudi::Units

! 2006-04-13 - Chris Jones
 - Add ALICE mode options to DAQ definitions

! 2006-04-10 - Antonis Papanestis
 - Changed DeRich to produce WARNING if alignment cond is not there, but not
   fail.
 - Increased active radius on pixel chip in HPDPanel.

! 2006-04-03 - Chris Jones
 - Update to printing to suppress messaging during initialize, but for all
   subsequent updates print a message.

!========================= RichDet v9r3 2006-03-29 =========================
! 2006-03-24 - Chris Jones
 - Modifications to RichDAQDefinitions.h

!========================= RichDet v9r2 2006-03-16 =========================
! 2006-03-16 - Chris Jones
 - Add some checks on the validity of the Rich1DTabProperty after they are
   created
 - Add a work around to the problem of Rich1DTabProperty objects being created
   before UMS has updated the underlying tables. This problem will "go away"
   once Rich1DTabProperty can automatically update itself on changes to the
   underlying tables
 - Some speed optimisations for the RichRadIntersections class

! 2006-03-15 - Antonis Papanestis
 - Added classes DeRichGasRadiator and DeRichAerogelRadiator to handle
   the update of the gas and aerogel properties. Small changes in the
   DeRich1/2 moving common code to the base class. Requires new xml.

!========================= RichDet v9r1 2006-03-01 =========================
! 2006-03-01 - Antonis Papanestis
 - added Rich1DTabFunc, Rich1DTabProperty and RichRadIntersection
 - new method intersections in DeRichRadiator

! 2006-02-22 - Antonis Papanestis
 - added functionality for sensitiveVolumeID

! 2006-02-21 - Chris Jones
 - Add loading of Rich1AerogelMonitor tool when creating aerogel DeRadiator

! 2006-02-16 - Chris Jones
 - Update DeRichSystem for improved treatment of inactive HPDs.
   Requires update to XmlConditions

! 2006-02-16 - Antonis Papanestis
 - Added 2nd order demagnification in the smartID->detectionPoint.
 - Fixed minor bug in readoutChannelList. Both in DeRichHPDPanel.

! 2006-02-14 - Marco Cattaneo
 - Add explicit Boost dependency to requirements

! 2006-02-06 - Chris Jones
 - Minor improvements to DeRichSystem (debug messaging etc.)

! 2006-02-01 - Antonis Papanestis
 - Added DeRichSystem and RichDAQDefinitions.h to handle the HPD numbering
   schemes

!========================= RichDet v9r0 2006-01-24 =========================
! 2006-01-24 - Antonis Papanestis
 - introduced alignment of mirrors in DeRich and DeRichSphMirror
   requires XmlConditions

! 2005-12-21 - Antonis Papanestis
 - Redesign of the HPDPanel. Remove Rich1 & Rich2 HPDPanel classes

! 2005-12-19 - Marco Cattaneo
 - Pick up RichTraceMode.h from LHCbKernel and remove RichKernel dependency

! 2005-12-14 - Antonis Papanestis
 - Move from CLHEP to MathCore
 - Drop DeRich1CdfHPDPanel and DeRichFlatMirror
 - Modifications for new RichSmartID and HPD numbering.

!========================= RichDet v8r5 2005-11-18 =========================
! 2005-10-14 - Chris Jones
 - Additions to radiator detector elements to load up RichCondition tools.
   Needed to ensure these tools are initialised before the detector elememts.
   Note - not entriely happy with this approach, but it seems to work.
   It is should be considered under review.

! 2005-09-23 - Antonis Papanestis
 - Modifications in DeRichSphMirror for the secondary spherical mirrors
 - MultiSolid radiator for the new aerogel

! 2005-07-13 - Antonis Papanestis
 - Allow for different reflectivity for every mirror segment.

!========================= RichDet v8r4 2005-05-24 =========================
! 2005-05-13 - Marco Clemencic
 - Use new ParamValidDataObject interface (DetDesc >= v15)

!========================= RichDet v8r3 2005-03-04 =========================
! 2005-02-22 - Chris Jones
 - Add fix to DeRichHPDPanel to protect against invalid pixel information
   being set into RichSmartID
 - Minor other improvements

!========================= RichDet v8r2 2005-02-08 =========================
! 2005-02-08 - Marco Cattaneo
 - Adapt to changed names of RichSmartID bit field accessors of GaudiObjDesc
   v7r*
 - Remove obsolete CLHEPStreams.h include

!========================= RichDet v8r1 2004-08-27 =========================
! 2004-10-27 - Chris Jones
 - Some additions minor changes to functions

! 2004-10-20 - Chris Jones
 - Tidy up inline and virtual functions (whilst solving a windows problem)

! 2004-10-18 - Chris Jones
 - Minor updates. Mainly addition of const here and there plus a few
   changes to functions.

! 2004-08-27 - Antonis Papanestis
 - added access to tabulated properties to DeRich and DeRichRadiator

! 2004-07-27 - Chris Jones
 - Add doxygen file documentation

!========================= RichDet v8r0 2004-07-01 =========================
! 2004-07-22 - Antonis Papanestis
 - Added documentation

! 2004-07-01 - Antonis Papanestis
 - added RichMirrorSegPosition for row/column info on mirrors provided
   by the DeRich class
 - changed method signature in HPDPanel to use RichTraceMode
 - minor improvements here and there

!========================= RichDet v7r2 2004-06-17 =========================
! 2004-06-10 - Chris Jones
 - Increase RichKernel usage to v5r*

!========================= RichDet v7r1 2004-04-18 =========================
! 2004-04-18 - Chris Jones
 - Remove cout error messages

!========================= RichDet v7r0 2004-03-18 =========================
! 2004-03-15 - Chris Jones
 - Add standard locations in TDS to Detector element header files

! 2004-02-16 - Antonis Papanestis
 - Removed DeRichPDPanel
 - Added local to global conversion for HPDPanel (globalPosition)

!========================= RichDet v6r5 2004-02-04 =========================
! 2004-01-28 - Antonis Papanestis
 - Started the process of removing DeRichPDPanel, by removing the .cpp file

! 2003-12-19 - Antonis Papanestis
 - Added global to local conversion for HPD Panels

!========================= RichDet v6r4 2003-12-08 =========================
! 2003-12-08 - Marco Cattaneo
 - Adapt requirements to pick up Gaudi v13

!========================= RichDet v6r3 2003-12-03 =========================
! 2003-12-03 - Antonis Papanestis
 - Restructured the DeRichRadiator class, making it a base class and adding
   DeRicgSingleSolid/DeRichMultiSolid Radiator

!========================= RichDet v6r2 2003-11-21 =========================

! 2003-11-23 - Chris Jones
 - Some improvements for efficiency

! 2003-11-21 - Antonis Papanestis
 - Added DeRich.h as a base class for DeRich1 and DeRich2 with a new function
   to return the side.
 - Modified heavily RichHPDPanel, Rich1HPDPanel, Rich1CdfHPDPanel and
   Rich2HPDPanel so that all the common code in in the HPDPanel class
 - Added a extra variable in the PDWindow method (with a default value) to
   use a simple (and quick) algorith for getting the HPD.
 - Removed support for MaPMTs
 - Spherical mirrors can now return their radius.

!========================= RichDet v6r1 2003-11-03 =========================
! 2003-11-02 - Chris Jones
 - A few speed improvements for digitisation
 - Switch to new RichKernel v4r0

! 2003-31-10 - Antonis Papanestis
 - minor improvements.

! 2003-10-14 - Antonis Papanestis
 - added a new function to the DeRichPDPanel and moved some of the
   functionality of the traceToDetectorWithoutEff from RichDetTools to RichDet.
 - improved the algorithm that finds the photoDetector within the Panel
 - added some more debug information.

!========================= RichDet v6r0 2003-08-29 =========================
! 2003-08-29 - Antonis Papanestis
 - added DeRichMaPMTPanel with classID = 12015. This will allow the use
   of MaPMTs as well as HPDs.
 - use of new names for user parameters in the xml.

! 2003-09-08 - Antonis Papanestis
 - added the Cdf member functions to the MaPMTPanel for the processing
   of SICBMC Rich data.

!========================= RichDet v5r0 2003-06-20 =========================
! 2003-06-20 - Antonis Papanestis
 - added DeRichPDPanel to allow for the introduction of MaPMTs.  All Panels
   inherit from PDPanel.
 - added function in DeRich(H)PDPanel to fill a vector with all
   possible RichSmartdIDs
 - bug fixes

!========================= RichDet v4r2 2003-06-17 =========================
! 2003-06-16 - Sebastien Ponce
 - use new package DetDescCnv
 - fixes for gcc 3.2/3.3

!========================= RichDet v4r1 2003-04-15 =========================
! 2003-04-01 - Chris Jones
 - Various bug fixes and optimisations for speed

!======================== RichDet v4r0 2003-01-22 ========================
! 2003-01-16 - Antonis Papanestis
  class DeRichHPDPanel has been split in 3 different classes, with the original
  class a common base class.
  There are new classID numbers:
  DeRich1HPDPanel = 12011
  DeRich2HPDPanel = 12012
  DeRich1CdfHPDPanel = 12013

!======================== RichDet v3r2 2002-12-04 ========================
! 2002-11-19 - Florence Ranjard
 - requirements - use new versions

!========================= RichDet v3r1 2002-11-18 ===========================
! 2002-11-13 - Chris Jones
 - Change RichKernel version to v2r*

!========================= RichDet v3r0 2002-11-07 ===========================
! 2002-11-04 - Antonis
  changed the parameter names in DeRich1 & 2

! 2002-10-30 - Antonis Papanestis
  added class for Rich1, made a lot of bug fixes

! 2002-07-16 - Antonis Papanestis
 - the package has now a completely new structure.

