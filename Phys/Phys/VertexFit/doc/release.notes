! $Id: release.notes,v 1.196 2010-08-19 07:01:14 jpalac Exp $
!===========================================================================
! Package     : VertexFit
! Responsible : Yuehong Xie
!===========================================================================
! 2015-11-01 - Gerhard Raven
 - replace endreq with endmsg

!======================= VertexFit v6r22 2015-10-05 ========================

! 2015-08-12 - Gerhard Raven
 - remove #include of obsolete Gaudi headers

!======================= VertexFit v6r21 2015-04-22 ========================

! 2015-03-20 - Eduardo Rodrigues
 - Fixed typo in forward reference of PVReFitterAlg.h.

! 2015-03-16 - Sascha Stahl
 - Added deprecation warning to PVTrackRemover.

! 2015-03-16 - Chris Jones
 - Add depreciation warnings to AdaptivePVReFitter and PVReFitter.

!========================= VertexFit v6r20 2014-10-30 =========================

! 2014-10-15 - Chris Jones
 - Add depreciation warnings to OfflineVertexFitter and PropertimeFitter
 - Add algorithm context names to Warnings and Errors from OfflineVertexFitter
   and MomentumCombiner.

!========================= VertexFit v6r19p1 2014-07-25 =========================

! 2014-07-18 - Gerhard Raven
 - Improve the error message in OfflineVertexFitter when it is requested to
   vertex two parallel particles.

!========================= VertexFit v6r19 2014-05-19 =========================

! 2014-05-13 - Vanya Belyaev
 - PVReFitterAlg.cpp : Change the default refitting tool from 
                       AdaptivePVReFitter to LoKi::PVReFitter, match change
                       in core DaVinci base classes.

!========================= VertexFit v6r18 2014-04-02 =========================

! 2014-04-01 - Yuehong
 - Temporarily disable the line that fails the fit if MassErr^2<-999 in
   OfflineVertexFitter (Not an April fool's joke).

!========================= VertexFit v6r17 2014-02-20 =========================

! 2014-02-17 - Chris Jones
 - Protect MomentumCombiner from sqrt(-number) FPE due to negative mass
   error squares. 
 - Fail the fit in MomentumCombiner if MassErr^2<-999 (same as for the 
   OfflineVertexFitter).

! 2014-02-14 - Chris Jones
 - Add a Warning message to OfflineVertexFitter to monitor how often fits
   are performed that create vertices with nDoF=0 ...
 - Add protection to AdaptivePVRefitter to protect against over/under flows
   in std::exp(...) for large exponents. Fixes an FPE exception.

! 2013-12-19 - Chris Jones
 - Add a warning message when a fit is failed due to the 
   'mass error squared < -999' check.

!========================= VertexFit v6r16 2013-10-02 =========================

! 2013-10-01 - Chris Jones
 - Add some protection in OfflineVertexFitter::classify against being passed
   a NULL Particle pointer.

! 2013-09-12 - Chris Jones
 - Add protection to AdaptivePVReFitter for NULL pointers.

!========================= VertexFit v6r15p1 2013-06-13 =========================

! 2013-05-25 - Chris Jones
 - Fix another clang 3.2 warning.

! 2013-05-17 - Chris Jones
 - Fix clang 3.2 warning.

!========================= VertexFit v6r15 2013-05-07 =========================

! 2013-05-06 - Chris Jones
 - Protect OfflineVertexFitter against an invalid ParticleID value in 
   isResonance. An exception is now thrown in this situation.

!========================= VertexFit v6r14p1 2013-02-20 =========================

! 2013-02-20 - Chris Jones
 - Minor clean up

!========================= VertexFit v6r14 2012-12-03 =========================

! 2012-12-03 - Chris Jones
 - Rework the check for negative MeasuredMassError^2 values in OfflineVertexFitter
   to only declare the fit a failure if the value is 'very' negative (<-999).
   Allows for cases where the value is only just negative (-1e-9).

! 2012-11-29 - Marco Clemencic
 - Added CMake configuration file.

! 2012-10-31 - Yuehong Xie
 - Add warning message in PropertimeFitter for the protection below
 - Avoid recalculating mass

! 2012-10-30 - Yuehong Xie
 - Protection against square root of negative value in PropertimeFitter

! 2012-10-29 - Chris Jones
 - Minor CPU optimisations in PropertimeFitter

!========================= VertexFit v6r13 2012-10-04 =========================

! 2012-07-27 - Chris Jones
 - Patch the OfflineVertexFitter to prevent negative mass errors being saved.
   Also declare such fits where something has obviously gone wrong a failure.

!========================= VertexFit v6r12 2012-07-26 =========================

! 2012-07-24 - Chris Jones
 - Use 'getIfExists' instead of seperate 'exists' and 'get' calls.

!========================= VertexFit v6r11 2012-07-09 =========================

! 2012-07-02 - Chris Jones
 - Remove usage of the (depreciated) OnOfflineTool

!========================= VertexFit v6r10 2012-06-28 =========================

! 2012-06-26 - Chris Jones
 - Suppress warnings in PVReFitterAlg about missing or empty Particle 
   locations in the TES. Can happen in the stripping.

! 2012-05-09 - Chris Jones
 - Remove obsolete "ParticleInputLocation" property from PVReFitterAlg. 
   Use "ParticleInputLocations" instead
 - Use the method removeTracksAndRecalculatePV instead of reDoSinglePV
   when using the IPVOfflineTool in PVReFitterAlg

!========================= VertexFit v6r9 2012-05-03 =========================

! 2012-05-03 - Chris Jones
 - Suppress messages about missing or empty vertex containers in PVReFitterAlg

!========================= VertexFit v6r8 2012-03-01 =========================

! 2012-02-18 - Chris Jones
 - Various minor clean ups and speed ups in AdaptivePVReFitter and 
   PVReFitterAlg

!========================= VertexFit v6r7p3 2011-11-10 =====================
! 2011-09-16 - Yuehong Xie
 - commit the changes for using new ParticlePropertySvc, which were forgot
   last time. 

!========================= VertexFit v6r7p2 2011-05-13 =====================
! 2011-05-10 - Yuehong Xie
 - migrate to new ParticlePropertySvc

!========================== VertexFit v6r7p1 2011-12-20 ====================

! 0211-02-19 - Chris Jones
 - Various icc and coverity fixes

!========================== VertexFit v6r7 2010-12-17 ======================

! 2010-10-25 - Juan Palacios
 - Added PVTrackRemover, an IPVReFitter that uses IPVOfflineTool's
   removeTracksAndCalculatePV method to remove the weighted contribution
   of the set of tracks making a particle from the PV.
   NOTE: This implementation is temporary and for testing. The reFit method
   has no meaning and isn't implemented. 
 - Increase to v6r7.

!========================== VertexFit v6r6 2010-11-02 ======================

! 2010-10-25 - Juan Palacios
 - src/AdaptivePVReFitter.cpp
  . Use const, pass by const reference wherever possible.
  . Remove unnecessary const_casts.
 - src/PVFitTrack.h
  . Enable construction from Track, pass by const reference semantics.

! 2010-10-24 - Juan Palacios
 - src/PVReFitterAlg.cpp
  . Fix memory leak. New PVs not deleted when re-fitting fails.
 - cmt/requirements
  . Increase to v6r5p1

!========================== VertexFit v6r5 2010-09-29 ======================

! 2010-09-26 - Yuehong Xie
 - OfflineVertexFitter
  . introduce new option "includeDauVertexChi2", which controls whether to add
    the chi2 and DOF of daughter vertices to the mother vertex. Default value
    is set to be true.
  . new option "applyMomMassConstraint" controls whether to  apply 
    mass constraint on the mother particle.  Default value is set to false.

!========================== VertexFit v6r4 2010-08-19 ======================

! 2010-08-12 - Juan Palacios
 - PVReFitterAlg.
  . Does not fail when particles or PVs not found. Just produces supressed 
    warning or error messages.

! 2010-08-04 - Juan Palacios
 - PVReFitterAlg
  . Can now process many particle input locations in parallel.
    Use property ParticleInputLocations. ParticleInputLocation is now
    deprecated but still works.
 - cmt/requirements
  . Increase to v6r4.

!========================== VertexFit v6r3p1 2010-07-26 ===============

! 2010-07-07 - Chris Jones
 - Very minor speed tweaks to OfflineVertexFitter

!========================== VertexFit v6r3 2010-06-21 =================

! 2010-06-21 - Juan Palacios
 - PVReFitterAlg
  . Change location of output PVs and relations tables. Now go to TES trunk
    of input particles.

! 2010-06-13 - Vanya Belyaev

 - OffliveVertexFitter.cpp

    replace "err" --> "Error" to reduce a bit the identiical printout 

 - cmt/requirements 

    version increment  to v6r2p3 


!========================== VertexFit v6r2p2 2010-04-15 ===============

! 2010-04-15 - Juan Palacios
 - src/PVReFitterAlg.cpp
  . use Particle::Range and RecVertex::Range for inputs.
 - cmt/requirements
  . Increase to v6r2p2

!========================== VertexFit v6r2p1 2010-04-07 ===============

! 2010-4-1 - Yuehong Xie
 - src/AdaptivePVReFitter.cpp
   . add protection against null track pointer in PV->tracks() 

!========================== VertexFit v6r2 2010-01-29 =================

! 2010-1-27 - Yuehong Xie
 - src/AdaptivePVReFitter.cpp
   . return failure (instead of success) if not enough tarcks in PV

! 2010-1-21 - Yuehong Xie
 - src/AdaptivePVReFitter.cpp
   . require at least 4 tracks after removing signal tracks from PV

!========================== VertexFit v6r1 2009-11-16 =================

! 2009-11-11 - Juan Palacios
 - src/PVReFitterAlg{.h, .cpp}
   . Use IOnOffline tool to determine input PV location.
   . Write unweighted table.
   . Output goes to <algo name>/Particle2VertexRelations, <algo name>/_ReFittedPVs.

!========================== VertexFit v6r0p1 2009-10-27 ===============

! 2009-10-09 - Yuehong Xie
 - Remove unused method in PVReFitter

! 2009-10-09 - Patrick Koppenburg
 - Adapt to changed in Track Event Model.
 - v6r0p1

!========================== VertexFit v6r0 2009-09-24 =================

! 2009-09-11 - Chris Jones
 - Speed improvements to identified during profiling with valgrind.

! 2009-09-01 - Juan PALACIOS
 - PVRefitterAlg
  . Adapt to change in Particle2Vertex typedefs: Table -> WTable

! 2009-08-24 - Patrick Koppenburg
 - TrgParticleMaker : add 
  declareInterface<IParticleCombiner>(this);
  declareInterface<IParticleReFitter>(this);
  -> v6r0

! 2009-08-19 - Vanya BELYAEV
 - OfflineVertexFitter, 
   TrgVertexFitter, 
   ParticleAdder
    
   change  a bit the signature due to modified IVertexFit: 
 
    1. for all methods, WITHOUT creation of "mother" particle, 
       the vertex os the first argument ( "fit vertex" ) 
    2. for all methdos WITH creation of "mother" particle, 
       the mother particle is the last argument , after vertex 
 

! 2009-08-18 - Juan PALACIOS
 - src/PVReFitter.cpp, AdaptivePVReFitter.cpp
  . Add missing includes
 - cmt/requirements
  . Increase version to v5r7p1

!========================== VertexFit v5r7 2009-08-11 =================

! 2009-07-28 - Juan PALACIOS
 - cmt/requirements
  . Remove dependency on DaVinciKernel
  . Increase version to v5r7

!========================== VertexFit v5r6p2 2009-07-23 ===============

! 2009-07-20 - Juan PALACIOS
 - src/PVRelatorAlg.h
  . Improve doxygen
 - cmt/requirements
  . Increase version to v5r6p2

!========================== VertexFit v5r6p1 2009-06-02 ===============

! 2009-05-29 - Patrick Koppenburg
 - A bit more debugging in OfflineVertexFitter
 - v5r6p1

!========================== VertexFit v5r6 2009-02-20 =================

! 2009-02-11 - Patrick Koppenburg
 - TrgVertexFit: Bug fix for PhiGamma. 
 - Increment to v5r6

! 2009-02-03 - Patrick Koppenburg
 - TrgVertexFitter: Switch off all Warnings
 - Increment to v5r5p1

!========================== VertexFit v5r5 2009-01-15 =================

! 2009-01-15 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v5r5

! 2008-12-22 - Patrick Koppenburg
 - Remove all .opts files

! 2008-11-24 - Juan PALACIOS
 - src/PVReFitterAlg.cpp
  . Simplify getTracks loop.
  . Add bool properties UseIPVOfflineTool(false) and UseIPVReFitter(true) 
    determining if the PV re-fitting tools should be used.

! 2008-11-20 - Juan PALACIOS
 - src/PVReFitterAlg.cpp
  . Add incremental weight to relations to keep same ordering as in input
    PV container. Otherwise it goes a bit random upon writing to DST or muDST.

! 2008-11-19 - Juan PALACIOS
 - src/PVReFitterAlg.cpp
  . void PVReFitterAlg::getTracks: scan decay tree looking for tracks, instead
    of only looking at direct descendants.
 - src/PVReFitterAlg.h
  . doxygen changes

! 2008-11-18 - Juan PALACIOS
 - src/PVReFitterAlg{.cpp, .h}
  . Remove all the ILifeTimeFitter/ProperTimeFitter stuff. It wasn't actually
    used for anything.
 - cmt/requirements
  . Increase version to v5r4p2

!========================== VertexFit v5r4p1 2008-10-06 =================

! 2008-10-06 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v5r4p1

! 2008-10-4 - Yuehong Xie
 - OfflineVertexFitter: fix problem in pi0 mass constraint reported 
   by Steven Blust

!========================== VertexFit v5r4 2008-09-11 ===================

! 2008-09-10 - Patrick Koppenburg for Yasmine Amhis
 - TrgVertexFitter: Treat pi0 the same way as gammas.
 - The LHC started today.

! 2008-09-09 - Juan PALACIOS
 - src/PVReFitterAlg.cpp
  . Clean up error messages.
  . Fix default PV location bug.

! 2008-09-09 - Juan PALACIOS
 - src/PVReFitterAlg{.cpp, .h}
  . Go back to KeyedContainer to store refitted vertices. ObjectVector 
    would've posed problems in client code and MicroDST cloning.
    It is now up to the user to know how to deal with these vertices.

! 2008-09-09 - Juan PALACIOS
 - src/PVReFitterAlg{.cpp, .h}
  . Now re-fit all PVs for all candidates instead of only related ones.
    Keep the key of the original PV in each case. Store in ObjectVector to
    allow more than one re-fitted vertex with the same key.

! 2008-09-08 - Juan PALACIOS
 - src/PVReFitterAlg{.cpp, .h}
  . Now a GaudiAlgorithm.

! 2008-08-19 - Juan PALACIOS
 - src/PVReFitterAlg{.cpp, .h}
  . No longer a DVAlgorithm, now a GaudiTupleAlg.
  . Add an IRelatedPVFinder and an IOnOffline.
 - cmt/requirements
  . Increase version to v5r4
!========================== VertexFit v5r3 2008-08-05 ===================
! 2008-07-07 - Juan PALACIOS
 - src/PVReFitterAlg.cpp, src/PVReFitterAlg.h
  . Make into DVAlgorithm (hopefully temporarilly).
  . Get related PVs from desktop.
  . Add verbose printouts 'cause for some reason it doesn't work at all.

 - cmt/requirements
  . Increase version to v5r3

!========================== VertexFit v5r2 2008-07-03 ===================

! 2008-07-03 - Juan PALACIOS
 - Add src/PVReFitterAlg.cpp, src/PVReFitterAlg.h
   . Simple GaudiAlgorithm that takes some particles, their related primary 
     vertices, and refits the vertices excluding the tracks coming from the 
     particle's decay. It also creates a relations table associating each 
     particle to its corresponding new vertex.
   . As yet COMPLETELY UNTESTED!

! 2008-07-02 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v5r2
 * These changes need Phys/DaVinciKernel v6r15 or hiigher.
 - src/AdaptivePVReFitter.cpp
 - src/AdaptivePVReFitter.h
 - src/PVReFitter.cpp
 - src/PVReFitter.h
  . Make all methods const. 
  . Make first argument of IPVReFitter::remove a const LHCb::Particle*

! 2008-05-30 - Patrick Koppenburg
 - TrgVertexFitter : Check StatusCodes

!========================== VertexFit v5r1 2008-04-24 ===================

! 2008-04-16 - Juan PALACIOS
 - src/OfflineVertexFitter.cpp
  . Use new IParticleTransporter::transportAndProject method. This has the same
    maths as the pre-v3r7p3 Phys/DaVinciTransporter ParticleTransporter::transport method.
 - cmt/requirements
  . Increment version to v5r1

! 2008-03-27 - Yuehong Xie
 - PVReFitter.cpp, OfflineVertexFitter.cpp, AdaptivePVReFitter.h: 
   fix compilation warnings

! 2008-03-27 - Patrick Koppenburg
 - PropertTimeFitter: check statuscodes
 - Increment to v5r0p1

!========================== VertexFit v5r0 2008-03-06 ===================

! 2008-03-06 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v5r0

! 2008-02-24 - Vanya BELYAEV

 - src/BlindVertexFitter.cpp
   src/FitterUtils.h
   src/MassFitter.cpp

     move these files into new packahe Phys/LoKiFitters

! 2008-02-20 - Patrick Koppenburg
 - Include Physical constants where needed

!========================== VertexFit v4r5 2008-02-05 ===================

! 2008-02-05 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v4r5
 
 - options/DVFlightDistanceFilterCriterion.opts
  . Remove .DLLs += line.

! 2008-01-15 - Vanya BELYAEV

 - src/MassFitter.cpp
   new class LoKi::MassFitter, 
   the most trivial implementation of IMassFit abstract interface 
   ATTENTION: the tool is not properly tested yet! to be done urgently!

 - src/MatrixUtils.h
   remove the obsolete file, use 
    LHCbMath/MatrixUtils.h & LHCbMath/MatrixTransforms.h instead
   the related files are updated properly 

!========================== VertexFit v4r4p1 2007-12-13 =================

! 2007-11-28 - Patrick Koppenburg
 - TrgVertexFitter: Protect against zero covariance matrix deteminant.

! 2007-11-27 - Patrick Koppenburg
 - TrgVertexFitter: issue a failure when stuffing failed.
 - Increment to v4r4p1

!========================== VertexFit v4r4 2007-11-14 ===================

 2007-11-14 - Yuehong Xie
  - src/AdaptivePVReFitter.cpp
    .use the right method to initialize std::vector<double>

! 2007-11-13 - Yuehong Xie
  - src/PVReFitter.cpp
    .bug fix: call clearTracks() to avoid duplicated tracks

! 2007-11-12 - Yuehong Xie
 - src/AdaptivePVReFitter.cpp(.h)
   . add new properties "reweightTracks", "temperatures", "criticalPoint"

! 2007-11-11 - Yuehong Xie
 - add src/AdaptivePVReFitter.cpp, AdaptivePVReFitter.h, PVFitTrack.h
   . A new tool for adaptive PV refitting using deterministic anneling 

!========================== VertexFit v4r3p3 2007-11-05 ====================

! 2007-11-02 - Yuehong Xie
 - src/OfflineVertexFitter.cpp
   . Fix bug: cov2=pos1 -> covariance()

! 2007-11-02 - Juan Palacios
 - cmt/requirements
  . Increase version to v4r3p3

! 2007-11-02 - Yuehong Xie
 - src/OfflineVertexFitter.cpp/.h
  . Add treatment of merged pi0
  . simplify the way to get photon parameters, 
    no chnage of performance expected

!========================== VertexFit v4r3p2 2007-10-25 ====================

! 2007-10-25 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v4r3p2

! 2007-10-18 - Yuehong Xie
 - PVReFitter.cpp
  . bug fix: replace  stateAtFirstMeas(tr) with tr->firstState()

!========================== VertexFit v4r3p1 2007-10-10 ====================

! 2007-10-11 - Patrick Koppenburg
 - TrgVertexFitter: protect against 0 denominators. 0 is defined as 
	 smaller that 10^{-16}. Can be changed by options
   . More verbose printout
   . Use pointers instead of references
   . retag as v4r3p1

! 2007-10-08 - Juan PALACIOS
 - src/OfflineVertexFitter.cpp
  . Remove last changes as they affect some pre-selections. Behaviour should
    now be the same as in revision 1.25. Revert to that version once 
    pre-selections have been adapted accordingly.
 - cmt/requirements
  . Increase version to v4r3p1

! 2007-10-05 - Yuehong Xie
  - src/OfflineVertexFitter.cpp
   . change the chi2 definition so that when "useResonanceVertex" is true,
     the chi2 and NDoF of no resonance are included for the mother. The 
     chi2 and NDoF of the first resonance were included by mistake.

! 2007-10-02 - Yuehong Xie
  - src/OfflineVertexFitter.cpp
   . fix a typo in addFlying method


!========================== VertexFit v4r3 2007-09-24 ======================

! 2007-09-24 - Juan PALACIOS
 - cmt/requirements
  . Increase version to v4r3

! 2007-08-22 - Juan Palacios
 - src/OfflineVertexFitter.h
   . Make all protected member functions private.
 - src/PVReFitter.h
   . Make all protected member functions private.
   . Use LHCb::Track::Vector and ConstVector typedefs instead of std::vector<...>
 
 - src/ParticleAdder{.h, .cpp}, src/TrgVertexFitter{.cpp, .h}
   . Remove unused protected methods isResonance and isVertexed
   . Minor clean up and move implementaitons of virtual functions to .cpp

! 2007-08-21 - Juan PALACIOS
 - src/OfflineVertexFitter{.cpp, .h}
   . Remove use of pow(10, N) and replace with definitions in Gaudi::Units or literals.
   . Add const wherever possible.
 - cmt/requirements
   . Increase version to v4r2p4

!========================== VertexFit v4r2p3 2007-07-30 ===================

! 2007-07-13 - Patrick Koppenburg
 - More verbose printout in TrgVertexFitter. Protect all printouts.

! 2007-07-06 - Patrick Koppenburg
 - Check Statuscode in TrgVertexFitter
 - Increment to v4r2p3

!========================== VertexFit v4r2p2 2007-05-26 ===================

! 2007-05-10 - Patrick Koppenburg
 - Check StatusCodes
 - Increment to v4r2p2

!========================== VertexFit v4r2p1 2007-04-26 ===================
! 2007-04-26 - Patrick Koppenburg
 - OfflineVertexFitter.cpp: More verbose() statements
 - Increment to v4r2p1

!========================== VertexFit v4r2 2007-04-19 ===================
! 2007-04-16 - Patrick Koppenburg
 - OfflineVertexFitter:
   . Add particles to vertex outgoingParticles whenever they are actually 
     used in the vertex fit.
   . Remove adding of particles to outgoingParticles at end of fit.
     This should solve a bug reported by Ulrich Kerzel.
   . Issue a harmless warning when the number of daughters is not
     the same as the number of outgoingParticles .
   . Replace all endreq by endmsg
 - incement to v4r2

!========================== VertexFit v4r1 2007-03-09 ===================
! 2007-03-05 - Patrick Koppenburg
 - get vector types from gaudiKernel

! 2007-02-28 - Patrick Koppenburg
 - Increment to v4r1

! 2007-02-06 - Yuehong Xie
  - PropertimeFitter.cpp: return tau (not ctau) in Gaudi unit of time,
    which is nanosecond.

! 2007-02-06 - P. Koppenburg
  - Offloine vertexfitter: add correct particles to vertex.

! 2007-02-02 - P. Koppenburg
  - TrgVertexFitter.cpp
    . Error matrices now start from (0,0) not (1,1).

!========================== VertexFit v4r0 2007-01-12 ==================
! 2007-01-12 - Florence Ranjard
 - use new FACTORY

!========================== VertexFit v3r3 2006-12-06 ===================

! 2006-12-06 - Juan PALACIOS

  - src/OfflineVertexFitter.cpp, BlindVertexFitter.cpp
    . Allow to change to private instance of IParticleTransporter in options.
      Default is ParticleTransporter:PUBLIC.
      Example to make private instance and modify a property:

      MyAlgo.OfflineVertexFitter.Transporter = "ParticleTransporter/SpecialTransporter";
      MyAlgo.OfflineVertexFitter.SpecialTransporter.TrackExtrapolator = "TrackMasterExtrapolator";

! 2006-12-05 - Juan PALACIOS
  - cmt/requirements: increase version to v3r3

! 2006-11-30 - Yasmine Amhis + Olivier Deschamps
  - Add ParticleAdder tool (IVertexFit interface)

!========================== VertexFit v3r2 2006-10-24 ===================

! 2006-10-22 - Yuehong Xie
  - change Veretx* into VertexBase* in  PropertimeFitter and DirectionFitter
  - fix a bug in PropertimeFitter

! 2006-10-16 - Juan PALACIOS
  - cmt/requirements
    . Increase version number to v3r2

! 2006-10-13 - Yuehong Xie
  -  src/OfflineVertexfitter.cpp
    . fix a typo in addPhoton and addPhotonPair method: 1l should be l1

!========================== VertexFit v3r1 2006-10-04 ===================

! 2006-10-04 - Yuehong Xie
  - src/OfflineVertexfitter.cpp
    . set mass related elements in the mass represantation of 
      covariance matrix of basic particles to zero to fix a bug in making
      basic particles. 

! 2006-10-02 - Yuehong Xie
  - src/OfflineVertexfitter.cpp
    . fix a bug with addFlying
    . comment temporary code for MCParticleMaker


! 2006-08-16 - Vanya BELYAEV
 - src/MomnetumCombiner.cpp
     add the simplest implementation of IParticleCombiner interface:
     the tool which combines particle using 4-momenta addition.

     Question here: Should it be "ParticleAdder" instead of "MomentumCombiner"?

 - src/VertexFit_load.cpp 
     add a tool declaration. needed fro component library 

 - src/OfflineVertexFitter.h
     add a "default" implemntation of IParticleCombiner::combine
     through the delegation to the method "fit" with the same signature.
 - src/OfflineVertexFitter.cpp
     add the declaration of interfaces into the tool constructor:
       declareInterface<IParticleCombiner>     
        declareInterface<IParticleReFitter>
 - cmt/requirements
     version increment to v3r1 
    

! 2006-08-02 - Juan PALACIOS
  - src/OfflineVertexFitter.cpp
    . Fix bug in updateParticle. Off-diagonal 4x3 position-momentum covariance matrix was erroneously extracted from 7x7 matrix.

!========================== VertexFit v3r0 2006-07-20 ===================

! 2006-07-20 - Juan PALACIOS
  - src/BlineVertexFitter.cpp
    . Use SMatrix::Inverse instead of SMatrix::Sinverse. Sinverse removed from SMatrix 5.12.
  - src/PVReFitter{.h, .cpp}
    . Modify to use new vertex classes.
  - cmt/requitemenrs
    . Increase version number to v3r0

!========================== VertexFit v2r2 2006-07-07 ===================

! 2006-07-05 - Juan PALACIOS
  - src/OfflineVertexFitter.cpp
    . Change location of Calo hypothesis enums according to changes in  
      RecEvent v1r5. Enums no longer in CaloHypothesis namespace but in
      CaloHypo class definition.

! 2006-06-12 Yuehong Xie
  - src/PVReFitter.cpp is completed now.

! 2006-06-08 Yuehong Xie
  - src/OfflineVertexFitter.cpp: fix a small bug 
  - add src/PVReFitter.cpp. Not finished yet.

! 2006-06-07 Yuehong Xie
  - add src/DirectionFitter.cpp. Uses IDirectionFit.h.

! 2006-06-07 Yuehong Xie
  - add src/PropertimeFitter.cpp. Uses ILifetimeFitter.h. 

! 2006-06-06 Juan PALACIOS 
  - src/OfflineVertexFitter.h: Fix a few compilation warnings to do with 
                               unimplemented methods

! 2006-06-07 Yuehong Xie
  - src/OfflineVertexFitter.cpp: set default value of applyDauMassConstraint to false.

! 2006-06-07 Yuehong Xie
  - src/OfflineVertexFitter.cpp: implement addPhotonPair. Now it should work with pi0/eta.

! 2006-06-06 Yuehong Xie
  - src/OfflineVertexFitter.cpp: implement addPhoton. Now it should work with photons.     

! 2006-05-31 Juan PALACIOS
  Remove src/MatrixUtils.h (moved to LHCbMath v1r1)
  src/BlindVertexFitter.cpp: Add Kernel to include path of MatrixUtils.h

!========================== VertexFit v2r1 2006-05-29 ===================

! 2006-05-30 Juan PALACIOS for Vanya BELYAEV
  src/MatrixUtils.h: Fix errouneous namespace for LorentzVector bug.

! 2006-05-26 Juan PALACIOS
  src/VertexFit_load.cpp: declare BlindVertexFitter as tool

! 2006-05-26 - Yuehong Xie
 - OfflineVertexFitter version for anything excpet photons, which will be added later
 - Only tested using Jpsi->mumu data from MCParticleMaker

! 2006-05-26 - Vanya BELYAEV
 - src/BlindVertexFitter.cpp
     - simple Kalman-filter based vertex fitter, 
       current implementation works only for basic charged particles
 - src/FitterUtils.h - helper namespace for implementation of vertex fitter 
 - src/MatrixUtils.h - helper file with set of helper matrix utilities   

! 2006-05-17 - Yuehong Xie
 - first version that only fit two tarck vertex like Jpsi->mumu, more functionalities to be added
 
! 2006-05-09 - P. Koppenburg
  Moved GeomDispCalculator to DaVinciTools

! 2006-05-08 - Juan PALACIOS
 - Added src/GeomDispCalculator. Re-implemented from DaVinciTransporter 
   and restored.

! 2006-04-05 - J. Palacios
 - src/TrgVertexFitter: change calls to Particle::slopeX(), slopeY() for calls to Particle::slopes(), adapting to new Particle interface.

! 2006-04-03 - J. Palacios
 - Added src/OfflineVertexFitter.h and .cpp from Yuehong Xie.
 - Modified src/OfflineVertexFitter.cpp:
   . Translate all matrix and vector operations from CLHEP-like lingo to
     SMatrix talk.

!========================== VertexFit v2r0 2006-03-28 ===================
! 2006-01-23 - P. Koppenburg
  - src/.*
    . Removed temporaryly except
  - src/TrgVertexFitter.{h,cpp}

! 2006-01-23 - P. Koppenburg
  - src/GeomDispCalculator.*
  - src/TrgDispCalculator.*
    . Moved to DaVinciTransporter
!========================== VertexFit v1r10 2006-02-03 ===================
! 2006-01-30 - Y. Xie
  - src/KFFitTool.cpp
    . replaced some err() with debug()
    . fixed the problem of wrongly setting resonance vertex position to
    the state position after transport
    . call setMass() for photon pair to allow for retrivial 
    of pi0/eta->gammagamma mass from KFFittool

!========================== VertexFit v1r9p1 2005-12-21 ===================
! 2005-12-20 - P. Koppenburg
  - src/LagrangeGlobalFitter.cpp
    . no need of Kernel/CLHEPStreams.h
!========================== VertexFit v1r9 2005-12-15 ===================
! 2005-12-09 - P. Koppenburg for L. Fernandez
  - src/KFFitTool.cpp
    . Replaced
    bool isPhotonPair = (daupid==111 || daupid==221);
      by
    bool isPhotonPair = isPurePhotonDecay(*dau);
      to allow proper treatment of eta->pipipi0
    . Remove unused variables.
  - src/TrgVertexFitter.cpp
    . Remove unused variables.

! 2005-11-16 - Gabriele Balbi & Stefania Vecchi
  - src/LagrangeGlobalFitter.{cpp,h}
    .added documentation
    .fixed a numerical bug	

! 2005-11-11 - P. Koppenburg for G. Balbi
  - src/LagrangeGlobalFitter.{cpp,h}
    . New global fitter

!========================== VertexFit v1r8 2005-10-19 ===================
! 2005-10-17 - P. Koppenburg for F. Legger
  - src/TrgVertexFitter.cpp
    . Adapt to needs of Lb->Lambda gamma channel.

!========================== VertexFit v1r7 2005-09-07 ===================
! 2005-09-02 - Yuehong Xie
  - src/PVReFitter.cpp 
  - src/PVReFitter.h
    . New PV refit tool
    . refit a primary type vertex 
    . remove all tracks of a particle from PV and refit PV
    . the problem of Velo/veloBack track charge is fixed by using Q=sign(tx)

!========================== VertexFit v1r6p1 2005-05-30 ===================
! 2005-05-24 - H.Ruiz
  - src/TrgVertexFitter.cpp
    . Reduced level of verbosity for debug mode. Most messages moved to 
      verbose mode

!========================== VertexFit v1r6 2005-05-12 ===================
! 2005-04-25 - P. Koppenburg for L. Fernandez
  - src/UnconstVertexFitter.cpp 
  - src/UnconstVertexFitter.h
    . Another modification for neutrals. New options      
      UseDaughters = true 
    . looks recursively for all final states (with origin) or long-lived daughters
      in the resonances' decay trees
    . all gammas(s) found in the descendants are re-evaluated at the vertex
    . does not refit vertex if only one composite and gamma(s)
    . for composites in the original list only decaying to gammas:
      Point on track, decay vertex, momentum are *not* changed
    . TEMPORARY fix: allow to fit only gammas, e.g. pi0 -> gamma gamma. This should not be allowed

! 2005-04-21 - Yuehong Xie
  - introduce new tool src/NewDirectionFitter.cpp(.h)
    .a upgraded version of LifetimeFitter. The difference is this tool fits
     for both time and mass at the same time. Correlation between time and
     mass is obtained. Based on this a mass constraint can then be applied 
  - src/KFFitTool.cpp
    . update vertex chi2 and NDoF when reFitting a Particle

!========================== VertexFit v1r5p1 2005-04-20 ===================
! 2005-04-14 - P. Koppenburg
  - src/LagrangeGeomVertexFitter.cpp
  - src/LagrangeMassVertexFitter.cpp
    . Removed unused and obsolete #include "Kernel/CLHEPStreams.h"
!========================== VertexFit v1r5 2005-03-03 ===================
! 2005-02-28 - Hugo Ruiz
  - src/TrgDispCalculator.cpp
    . Implemented the method calcCloseAppr, that computes the minimum
      distance of approach between tracks

! 2005-02-25 - P. Koppenburg
  - src/GeomDispCalculator.{cpp,h}
  - src/LagrangeGeomVertexFitter.{cpp,h}
  - src/LagrangeMassVertexFitter.{cpp,h}
    . Because of yet another bug of the new CLHEP 1.9, whenever one includes
      HepSymMatrix.h *after* *Point*.h, one does not get the mtheod
      00214    HepSymMatrix sub(int min_row, int max_row);
      which results in the run-trime error
      relocation error: .../slc3_ia32_gcc323/lib*.so: undefined symbol: _ZN5CLHEP12HepSymMatrix3subEii
    -> Include HepSymMatrix at the very beginning of the file.
    
! 2005-02-24 - P. Koppenburg for Hugo Ruiz
  - src/TrgVertexFitter.{cpp,h}
    . Do not fix vector sizes
! 2005-02-21 - P. Koppenburg for Hugo Ruiz
  - src/TrgVertexFitter.{cpp,h}
    . Fixes for resonant states and photons.
!========================== VertexFit v1r4 2005-02-22 ===================
! 2005-02-22 - P. Koppenburg
  - src/TrgVertexFitter.cpp
    . Windows does not know what to do with
         const int n = someVector.size() ;
	 double X[n] ;
      Use std::vectors throughout	 

! 2005-02-09 - P. Koppenburg
  - src/GeomDispCalculator.cpp
  - src/GeomDispCalculator.h
  - src/KFFitTool.cpp
  - src/KFFitTool.h
  - src/LifetimeFitter.cpp
  - src/LifetimeFitter.h
  - src/TrgDispCalculator.cpp
    . Adapt to the plain stupid new structure of CLHEP 1.9, ensuring
      backward compatibility (hence no forward declarations). One cannot
      mix Vectors and Points in formulae anymore. One cannot easily convert
      one to the others. :-(
    . Make them GaudiTools where not already done.
    . Fix a few compilation warnings.

! 2005-02-08 - P. Koppenburg for Hugo Ruiz
  - src/TrgVertexFitter.{cpp,h}
    . New version that accepts intermediate states. Works fine with
      short-lived resonances but not yet well with long-lived like D0.
  - src/TrgDispCalculator.{cpp,h}
    . New tool that performs the job of the GeomDispCalculator
      and uses the sames assumptions as the TRgVertexFitter. Gets identical
      results under these assumptions.
  
! 2005-02-04 - P. Koppenburg
  - src/TrgVertexFitter.{cpp,h}
    . Fast Unconstrained Vertex Fitter by Hugo Ruiz.
      Works only with Particles made from TrgTracks. Assumes cylindrical 
      errors around the trajectory.
  - src/VertexFitter_load.cpp
    . Use it.
  - src/UnconstVertexFitter.{cpp,h}
    . Make it a little more readable

!========================== VertexFit v1r3 2005-01-18 ===================
! 2005-01-06 - P. Koppenburg
  - src/*.h
    . Moved all interface to $DAVINCIKERNELROOT/Kernel/
    
! 2004-12-15 - P. Koppenburg
  - src/UnconstVertexFitter.cpp
    . Initialize GaudiTool
! 2004-12-14 - P. Koppenburg for Luis Fernandez
  - src/UnconstVertexFitter.*
    . Add the possibility to treat photons correctly
    . Make it a GaudiTool
    -> yet to be tested
  
!========================== VertexFit v1r2 2004-12-01 ===================
! 2004-11-25 - Yuehong Xie
  - Modified KFFitTool.cpp/.h to make it work with Ks

! 2004-11-04 - Yuehong Xie
 - New tool KFFitTool.cpp/.h basically does
  . recomputation of track covariance matrix to fix a bug in Particle class
  . vertex fitting with Kalman Filter method
  . mass constraint of narrow width resonant particles 
  . adding photon or photon pair to a vertex and giving correct covariance matrix 
  . At the moment Kshort is not reprocessed. 
 - LagrangeDirectionFitter.cpp/.h
  . Add new method fitWithDirection which returns the modified primary vertex
  . Now Direction fitter and LifetimeFitter give very similar result
 - LifetimeFitter.cpp
  . Always check if matrix inversion is successful or not


!========================== VertexFit v1r1 2004-09-16 ===================
! 2004-08-25 - P. Koppenburg
 - cmt/requirements
   . Do not export header files

!========================== VertexFit v1r0 2004-08-24 ===================
! 2004-08-24 - P. Koppenburg
 - Made a mistake while importing DaVinciFilter, overwriting VertexFit. 
   Had to remove all filters from VertexFit.

! 2004-08-23 - P. Koppenburg
 - New package VertexFit extracted from DaVinciTools,
   containing all vertex fitters and assocaited tools.

! 2004-08-23 - P. Koppenburg
 - Split DaVinciTools package into 
   . Phys/DaVinciKernel : DVAlgorithm, PhysDesktop and all Interfaces
   . Phys/ParticleMaker : All particle makers and the ParticleStuffer
   . Phys/DaVinciFilter : All Filter
   . Phys/VertexFit : All vertex fitters and the GeomDispCalculator.cpp
   . Phys/DaVinciTransporter : All transporters
   . Phys/DaVinciTools : Basically all high-level tools that are none
        of the abvove, f.i. DecayFinder, PreDV, CheckOverlap...    
   This split became necessary since DaVinciTools was become a huge monster
   containing unrelated stuff (what do the TrackTypeFilterCriterion and the 
   CombinedParticleMaker have in common?). Also DaVinciTools was evolving
   with all versions of DaVinci. In the short term, I hope that most 
   developments will affect DaVinciFilter, while the other packages will
   be rather stable except for bug fixes.
   
!========================== DaVinciTools v10r3 2004-08-23 ===================
! 2004-08-23 - Florence RANJARD
 - replace GaudiTools/ with GaudiAlg

!========================== DaVinciTools v10r0 2004-07-22 ===================
! 2004-07-20 - P. Koppenburg
  - src/LagrangeMassVertexFitter.cpp
    . Bug affecting only Windows
      -> put definitions
         Particle* part3 = pList[2];
         Particle* part4 = pList[3];
      in the sections where one knows that there are more than 2 particles.

  - src/LifetimeFitter.cpp
    . posMomCorr() was misused as the upper square in LifetimeFitter.cpp, 
      and this is fixed.
!========================= DaVinciTools v9r5 2004-06-04 ===================
! 2004-06-04 - P. Koppenburg
  - src/LagrangeGeomVertexFitter.cpp
    . String over two lines corrected for Windows
    
! 2004-05-11 - P. Koppenburg for Claudia Pereira Nunes
 - src/LagrangeGeomVertexFitter.{cpp,h}
 - DaVinciTools/IGeomVertexFitter.h
   . New constrained vertex fitting tool. This tool has two public methods. 
     One, called fitWithGeom, makes only a geometrical  constrained fit for 
     at most 4 tracks. It doesn't make any kind of invariant mass vertex fit, 
     like the LagrangeMassVertexFitter tool does, it just constrain the
     particles to come from the same point. The other method, called 
     fitWithGeomAndSubMass, makes a geometrical constrained fit and an 
     invariant mass constrained fit of any daughter which is a resonance 
     (with width < 10 MeV).  This method only works if there is a daughter 
     resonance and it works for at most 4 tracks also. 
 - src/LagrangeMassVertexFitter.{cpp,h}
   . Corrected an error on the way the geometrical constrained 
     equations were being obtained.

!========================== DaVinciTools v9r2 2004-03-31 ==================
! 2004-03-30 - P. Koppenburg for Miriam Gandelman
 - src/GeomDispCalculator.cpp
   . Bug fix
  
!========================== DaVinciTools v8r4 2004-01-29 ==================
! 2004-01-14 - Gloria CORTI
 - DaVinciTools/IGeomDispCalCulator.h
   src/GeomDispCalculator.{h,cpp}
   . propagate change from DaVinci v8r3 that was built on a branch  
   
!========================== DaVinciTools v8r3 2003-12-12 ==================
! 2003-12-12 - Gloria CORTI for Miriam GANDELMAN
 Built on a branch v8r2b
 - DaVinciTools/IGeomDispCalCulator.h
   src/GeomDispCalculator.{h,cpp}
   . new interface method introduced to provide the error for each of
     the component of the IP vector. The method requires a Particle and
     a Vertex as input and returns 4 variables in the following order:
     the IP, the IP error, the full IP vector and the error on the IP
     vector.

!========================== DaVinciTools v8r1p2 2003-06-26 ==================
! 2003-06-26 - Gloria CORTI
 - src/LagrangeMassVertexFitter.h & cpp
   . introduce method finalize where tools are released (valgrind 
     possible memory leak)
 - src/GeomDispCalculator.h & cpp
   . introduce method finalize where tools are released (valgrind
     possible memory leak )
   . introduce protection in method calcVertexDis() when dist = 0
     appearing wtih special configuration of Bd->D0 K* jobs (Miriam
     GANDELMAN)
!========================== DaVinciTools v8r1 2003-06-03 ====================
! 2003-05-05 - Gerhard Raven
 - DaVinciTools/ILifetimeFitter.h
 - src/LifetimeFitter.{cpp,h}
   . add code to compute, given a particle and its production vertex,
     the corresponding particle lifetime

! 2002-11-11 - Gloria Corti
 - Fix problem in tree propagation in UnconstVertexFitter when using 
   resonances and fix bug reported by Gerhard Raven of hessian/2 (Sandra Amato)
 - Introduce property with cut value on width of mother particle in order to
   use products or not to make vertex in LagrangeMassVertexFitter (S.Amato)
   leave uncommented the setIsResonance. When using this tool the tree is still
   not correctly progagated.

!=========================== DaVinciTools v6r0 2002-10-30 ===================
! 2002-10-29 - Gloria Corti
 - Comment temporarly the use of setIsResonance(true) in ParticleStuffer
   and LagrangeMassVertexFitter because of consequent missing step of
   intermediate particle when creating a new vertex in vertex fitters when
   daughters of resonaces are used.

! 2002-10-22 - Gloria Corti
 - Modified UnconstVertexFitter, LagrangeMassVertexFitter and
   GeomDispCalculator to be able to set which Transporter to use
   (CombinedTransporter beeing the default (as in v5r0)). An example of
   how to do it can be found in the DaVinciTest package.
 - Introduce new method in IMassVertexFitter to give 4 particles as input
   (C.Nunes, S.Amato)
 - Modified LagrangeMassVertexFitter (C.Nunes, A.Amato)
    + handle fits up to 4 particles,
    + set the flag isResonance() to new particles if lifetime < exp-15sec
    + check if a particle is a resonace in which case uses the daughters
      to perform the fit when widht < 10 MeV
    + fix error reported by B.Viaud to use transported values of slopes
      and momentum and not only positions
 - Modified UnconstVertexFitter (S.Amato) 
    + check if a particle is a resonace in which case uses the daughters
      to perform the fit
    + fix error reported by B.Viaud to use transported values of slopes
      and momentum and not only positions

! 2002-09-11 - Gloria Corti
 - New tool NeutralParticleMaker from Frederic Machefert
 - Modification in GeomDispCalculator and ParticleStuffer to take into
   account different dimension in error correlation matrix in Particle
 - Changes in PhysDesktop to fix bug noted by Sandra of copying initial
   particle when daughters of a new particle.
 - Use PhysEvent v7r0 and increase version number

!=========================== DaVinciTools v5r0 2002-07-29 ===================
! 2002-07-27 - Gloria Corti
 - Add error calculation in DCA for parallel particles in 
   GeomDispCalculator ( M.Gandelman )

! >>>>>>>>>>>>>>>>>>>>>>>>>> DaVinciTools v4r0 <<<<<<<<<<<<<<<<<<<<<<<<<
! 2002-05-10 - Gloria Corti
  - IMassVertexFitter: modify names of method to generic names (GC)
  - LagrangeVertexFitter: shortcut methods (Joao de Mello)

! 2002-05-06 - Gloria Corti
  - DaVinciTools/IVertexFitter.h: new methods (short-cuts) for 2 and 3 
  - src/UnconsVertexFitter: short cut methods implementation (Sandra Amato)
  - DaVinciTools/IGeomDispCalculator.h: return type of method changed from
    void to StatusCode (Miriam Gandelman)
  - src/GeomDispCalculator: use transporter (Miriam Gandelman)

! ======================================================================
! 20020402 - DaVinciTools v3r0 (G.Corti)
    - DaVinciTools/IVertexFitter.h, interface for generic vertex fitters
      src/UnconstVertexFitter.h&cpp, concrete implementation of a vertex fitter
          based on Fortran axksvrtx.F
      author: Sandra Amato      
    - DaVinciTools/IMassVertexFitter.h, interface for mass constrained vertex
                                       fitters
      src/LagrangeMassVertexFitter.h&cpp, concrete implementation using
          Lagrangian Multipliers
      author: Joao de Mello
  - Introduce new OO tools working with new PhysEvent model
    The interfaces are in DaVinciTools subdirectory.
    - DaVinciTools/IGeomDispCalculator.h (interface)
      src/GeomDispCalculator.h&cpp 
          Tool to calculate varius geometrical distances between Particles & 
          Vertices (ex. impact parameter) 
      author: Miriam Gandelman

                            
